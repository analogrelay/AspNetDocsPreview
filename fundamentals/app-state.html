

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Managing Application State &mdash; ASP.NET  documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/custom.css?v=6" type="text/css" />
  

  
    <link rel="top" title="ASP.NET  documentation" href="../index.html"/>
        <link rel="up" title="Fundamentals" href="index.html"/>
        <link rel="next" title="Servers" href="servers.html"/>
        <link rel="prev" title="Working with Multiple Environments" href="environments.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> ASP.NET
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting-started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference external" href="https://docs.asp.net/projects/api">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../conceptual-overview/index.html">Conceptual Overview</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Fundamentals</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="startup.html">Application Startup</a></li>
<li class="toctree-l2"><a class="reference internal" href="middleware.html">Middleware</a></li>
<li class="toctree-l2"><a class="reference internal" href="static-files.html">Working with Static Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="routing.html">Routing</a></li>
<li class="toctree-l2"><a class="reference internal" href="diagnostics.html">Diagnostics</a></li>
<li class="toctree-l2"><a class="reference internal" href="error-handling.html">Error Handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="localization.html">Globalization and localization</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="logging.html">Logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="file-providers.html">ðŸ”§ File Providers</a></li>
<li class="toctree-l2"><a class="reference internal" href="dependency-injection.html">Dependency Injection</a></li>
<li class="toctree-l2"><a class="reference internal" href="environments.html">Working with Multiple Environments</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Managing Application State</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="servers.html">Servers</a></li>
<li class="toctree-l2"><a class="reference internal" href="request-features.html">Request Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="owin.html">OWIN</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../mvc/index.html">MVC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../testing/index.html">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data/index.html">Working with Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../client-side/index.html">Client-Side Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mobile/index.html">Mobile</a></li>
<li class="toctree-l1"><a class="reference internal" href="../publishing/index.html">Publishing and Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hosting/index.html">Guidance for Hosting Providers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../security/index.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../performance/index.html">Performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../migration/index.html">Migration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contribute/index.html">Contribute</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">ASP.NET</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="index.html">Fundamentals</a> &raquo;</li>
      
    <li>Managing Application State</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/fundamentals/app-state.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
  <div class="section" id="managing-application-state">
<h1>Managing Application State<a class="headerlink" href="#managing-application-state" title="Permalink to this headline">Â¶</a></h1>
<p>By <a class="reference external" href="http://ardalis.com">Steve Smith</a></p>
<p>In ASP.NET Core, application state can be managed in a variety of ways, depending on when and how the state is to be retrieved. This article provides a brief overview of several options, and focuses on installing and configuring Session state support in ASP.NET Core applications.</p>
<div class="contents local topic" id="sections">
<p class="topic-title first">Sections</p>
<ul class="simple">
<li><a class="reference internal" href="#application-state-options" id="id2">Application State Options</a></li>
<li><a class="reference internal" href="#working-with-httpcontext-items" id="id3">Working with HttpContext.Items</a></li>
<li><a class="reference internal" href="#installing-and-configuring-session" id="id4">Installing and Configuring Session</a></li>
<li><a class="reference internal" href="#a-working-sample-using-session" id="id5">A Working Sample Using Session</a></li>
</ul>
</div>
<p><a class="reference external" href="https://github.com/aspnet/Docs/tree/master/aspnet/fundamentals/app-state/sample">View or download sample code</a></p>
<div class="section" id="application-state-options">
<h2><a class="toc-backref" href="#id2">Application State Options</a><a class="headerlink" href="#application-state-options" title="Permalink to this headline">Â¶</a></h2>
<p><cite>Application state</cite> refers to any data that is used to represent the current representation of the application. This includes both global and user-specific data. Previous versions of ASP.NET (and even ASP) have had built-in support for global <code class="docutils literal"><span class="pre">Application</span></code> and <code class="docutils literal"><span class="pre">Session</span></code> state stores, as well as a variety of other options.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <code class="docutils literal"><span class="pre">Application</span></code> store had the same characteristics as the ASP.NET <code class="docutils literal"><span class="pre">Cache</span></code>, with fewer capabilities. In ASP.NET Core, <code class="docutils literal"><span class="pre">Application</span></code> no longer exists; applications written for previous versions of ASP.NET that are migrating to ASP.NET Core replace <code class="docutils literal"><span class="pre">Application</span></code> with a <a class="reference internal" href="../performance/caching/index.html"><span class="doc">Caching</span></a> implementation.</p>
</div>
<p>Application developers are free to use different state storage providers depending on a variety of factors:</p>
<ul class="simple">
<li>How long does the data need to persist?</li>
<li>How large is the data?</li>
<li>What format is the data?</li>
<li>Can it be serialized?</li>
<li>How sensitive was the data? Could it be stored on the client?</li>
</ul>
<p>Based on answers to these questions, application state in ASP.NET Core apps can be stored or managed in a variety of ways.</p>
<div class="section" id="httpcontext-items">
<h3>HttpContext.Items<a class="headerlink" href="#httpcontext-items" title="Permalink to this headline">Â¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">Items</span></code> collection is the best location to store data that is only needed while processing a given request. Its contents are discarded after each request. It is best used as a means of communicating between components or middleware that operate at different points in time during a request, and have no direct relationship with one another through which to pass parameters or return values. See <a class="reference internal" href="#working-with-httpcontext-items">Working with HttpContext.Items</a>, below.</p>
</div>
<div class="section" id="querystring-and-post">
<h3>Querystring and Post<a class="headerlink" href="#querystring-and-post" title="Permalink to this headline">Â¶</a></h3>
<p>State from one request can be provided to another request by adding values to the new request&#8217;s querystring or by POSTing the data. These techniques should not be used with sensitive data, because these techniques require that the data be sent to the client and then sent back to the server. It is also best used with small amounts of data. Querystrings are especially useful for capturing state in a persistent manner, allowing links with embedded state to be created and sent via email or social networks, for use potentially far into the future. However, no assumption can be made about the user making the request, since URLs with querystrings can easily be shared, and care must also be taken to avoid <a class="reference external" href="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)">Cross-Site Request Forgery (CSRF)</a> attacks (for instance, even assuming only authenticated users are able to perform actions using querystring-based URLs, an attacker could trick a user into visiting such a URL while already authenticated).</p>
</div>
<div class="section" id="cookies">
<h3>Cookies<a class="headerlink" href="#cookies" title="Permalink to this headline">Â¶</a></h3>
<p>Very small pieces of state-related data can be stored in Cookies. These are sent with every request, and so the size should be kept to a minimum. Ideally, only an identifier should be used, with the actual data stored somewhere on the server, keyed to the identifier.</p>
</div>
<div class="section" id="session">
<h3>Session<a class="headerlink" href="#session" title="Permalink to this headline">Â¶</a></h3>
<p>Session storage relies on a cookie-based identifier to access data related to a given browser session (a series of requests from a particular browser and machine). You can&#8217;t necessarily assume that a session is restricted to a single user, so be careful what kind of information you store in Session. It is a good place to store application state that is specific to a particular session but which doesn&#8217;t need to be persisted permanently (or which can be reproduced as needed from a persistent store). See <a class="reference internal" href="#installing-and-configuring-session">Installing and Configuring Session</a>, below for more details.</p>
</div>
<div class="section" id="cache">
<h3>Cache<a class="headerlink" href="#cache" title="Permalink to this headline">Â¶</a></h3>
<p>Caching provides a means of storing and efficiently retrieving arbitrary application data based on developer-defined keys. It provides rules for expiring cached items based on time and other considerations. Learn more about <a class="reference internal" href="../performance/caching/index.html"><span class="doc">Caching</span></a>.</p>
</div>
<div class="section" id="configuration">
<h3>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">Â¶</a></h3>
<p>Configuration can be thought of as another form of application state storage, though typically it is read-only while the application is running. Learn more about <a class="reference internal" href="configuration.html"><span class="doc">Configuration</span></a>.</p>
</div>
<div class="section" id="other-persistence">
<h3>Other Persistence<a class="headerlink" href="#other-persistence" title="Permalink to this headline">Â¶</a></h3>
<p>Any other form of persistent storage, whether using Entity Framework and a database or something like Azure Table Storage, can also be used to store application state, but these fall outside of what ASP.NET supports directly.</p>
</div>
</div>
<div class="section" id="working-with-httpcontext-items">
<h2><a class="toc-backref" href="#id3">Working with HttpContext.Items</a><a class="headerlink" href="#working-with-httpcontext-items" title="Permalink to this headline">Â¶</a></h2>
<p>The <code class="docutils literal"><span class="pre">HttpContext</span></code> abstraction provides support for a simple dictionary collection of type <code class="docutils literal"><span class="pre">IDictionary&lt;object,</span> <span class="pre">object&gt;</span></code>, called <code class="docutils literal"><span class="pre">Items</span></code>. This collection is available from the start of an <cite>HttpRequest`</cite> and is discarded at the end of each request. You can access it by simply assigning a value to a keyed entry, or by requesting the value for a given key.</p>
<p>For example, some simple <a class="reference internal" href="middleware.html"><span class="doc">Middleware</span></a> could add something to the <code class="docutils literal"><span class="pre">Items</span></code> collection:</p>
<div class="highlight-c#"><div class="highlight"><pre><span></span><span class="n">app</span><span class="p">.</span><span class="n">Use</span><span class="p">(</span><span class="k">async</span> <span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">next</span><span class="p">)</span> <span class="p">=&gt;</span>
  <span class="p">{</span>
    <span class="c1">// perform some verification</span>
    <span class="n">context</span><span class="p">.</span><span class="n">Items</span><span class="p">[</span><span class="s">&quot;isVerified&quot;</span><span class="p">]</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
    <span class="k">await</span> <span class="n">next</span><span class="p">.</span><span class="n">Invoke</span><span class="p">();</span>
  <span class="p">});</span>
</pre></div>
</div>
<p>and later in the pipeline, another piece of middleware could access it:</p>
<div class="highlight-c#"><div class="highlight"><pre><span></span><span class="n">app</span><span class="p">.</span><span class="n">Run</span><span class="p">(</span><span class="k">async</span> <span class="p">(</span><span class="n">context</span><span class="p">)</span> <span class="p">=&gt;</span>
<span class="p">{</span>
  <span class="k">await</span> <span class="n">context</span><span class="p">.</span><span class="n">Response</span><span class="p">.</span><span class="n">WriteAsync</span><span class="p">(</span><span class="s">&quot;Verified request? &quot;</span>
    <span class="p">+</span> <span class="n">context</span><span class="p">.</span><span class="n">Items</span><span class="p">[</span><span class="s">&quot;isVerified&quot;</span><span class="p">]);</span>
<span class="p">});</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Since keys into <code class="docutils literal"><span class="pre">Items</span></code> are simple strings, if you are developing middleware that needs to work across many applications, you may wish to prefix your keys with a unique identifier to avoid key collisions (e.g. &#8220;MyComponent.isVerified&#8221; instead of just &#8220;isVerified&#8221;).</p>
</div>
</div>
<div class="section" id="installing-and-configuring-session">
<span id="id1"></span><h2><a class="toc-backref" href="#id4">Installing and Configuring Session</a><a class="headerlink" href="#installing-and-configuring-session" title="Permalink to this headline">Â¶</a></h2>
<p>ASP.NET Core ships a session package that provides middleware for managing session state. You can install it by including a reference to the <code class="docutils literal"><span class="pre">Microsoft.AspNetCore.Session</span></code> package in your project.json file.</p>
<p>Once the package is installed, Session must be configured in your application&#8217;s <code class="docutils literal"><span class="pre">Startup</span></code> class. Session is built on top of <code class="docutils literal"><span class="pre">IDistributedCache</span></code>, so you must configure this as well, otherwise you will receive an error.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you do not configure at least one <code class="docutils literal"><span class="pre">IDistributedCache</span></code> implementation, you will get an exception stating &#8220;Unable to resolve service for type &#8216;Microsoft.Extensions.Caching.Distributed.IDistributedCache&#8217; while attempting to activate &#8216;Microsoft.AspNetCore.Session.DistributedSessionStore&#8217;.&#8221;</p>
</div>
<p>ASP.NET ships with several implementations of <code class="docutils literal"><span class="pre">IDistributedCache</span></code>, including an in-memory option (to be used during development and testing only). To configure session using this in-memory option add the <code class="docutils literal"><span class="pre">Microsoft.Extensions.Caching.Memory</span></code> package in your project.json file and then add the following to <code class="docutils literal"><span class="pre">ConfigureServices</span></code>:</p>
<div class="highlight-c#"><div class="highlight"><pre><span></span><span class="n">services</span><span class="p">.</span><span class="n">AddCaching</span><span class="p">();</span>
<span class="n">services</span><span class="p">.</span><span class="n">AddSession</span><span class="p">();</span>
</pre></div>
</div>
<p>Then, add the following to <code class="docutils literal"><span class="pre">Configure</span></code> and you&#8217;re ready to use session in your application code:</p>
<div class="highlight-c#"><div class="highlight"><pre><span></span><span class="n">app</span><span class="p">.</span><span class="n">UseSession</span><span class="p">();</span>
</pre></div>
</div>
<p>You can reference Session from <code class="docutils literal"><span class="pre">HttpContext</span></code> once it is installed and configured.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you attempt to access <code class="docutils literal"><span class="pre">Session</span></code> before <code class="docutils literal"><span class="pre">UseSession</span></code> has been called, you will get an <code class="docutils literal"><span class="pre">InvalidOperationException</span></code> exception stating that &#8220;Session has not been configured for this application or request.&#8221;</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">If you attempt to create a new <code class="docutils literal"><span class="pre">Session</span></code> (i.e. no session cookie has been created yet) after you have already begun writing to the <code class="docutils literal"><span class="pre">Response</span></code> stream, you will get an <code class="docutils literal"><span class="pre">InvalidOperationException</span></code> as well, stating that &#8220;The session cannot be established after the response has started&#8221;. This exception may not be displayed in the browser; you may need to view the web server log  to discover it, as shown below:</p>
</div>
<img alt="../_images/session-after-response-error.png" src="../_images/session-after-response-error.png" />
<div class="section" id="implementation-details">
<h3>Implementation Details<a class="headerlink" href="#implementation-details" title="Permalink to this headline">Â¶</a></h3>
<p>Session uses a cookie to track and disambiguate between requests from different browsers. By default this cookie is named &#8221;.AspNet.Session&#8221; and uses a path of &#8220;/&#8221;. Further, by default this cookie does not specify a domain, and is not made available to client-side script on the page (because <code class="docutils literal"><span class="pre">CookieHttpOnly</span></code> defaults to <code class="docutils literal"><span class="pre">true</span></code>).</p>
<p>These defaults, as well as the default <code class="docutils literal"><span class="pre">IdleTimeout</span></code> (used on the server independent from the cookie), can be overridden when configuring <code class="docutils literal"><span class="pre">Session</span></code> by using <code class="docutils literal"><span class="pre">SessionOptions</span></code> as shown here:</p>
<div class="highlight-c#"><div class="highlight"><pre><span></span><span class="n">services</span><span class="p">.</span><span class="n">AddSession</span><span class="p">(</span><span class="n">options</span> <span class="p">=&gt;</span>
<span class="p">{</span>
  <span class="n">options</span><span class="p">.</span><span class="n">CookieName</span> <span class="p">=</span> <span class="s">&quot;.AdventureWorks.Session&quot;</span><span class="p">;</span>
  <span class="n">options</span><span class="p">.</span><span class="n">IdleTimeout</span> <span class="p">=</span> <span class="n">TimeSpan</span><span class="p">.</span><span class="n">FromSeconds</span><span class="p">(</span><span class="m">10</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">IdleTimeout</span></code> is used by the server to determine how long a session can be idle before its contents are abandoned. Each request made to the site that passes through the Session middleware (regardless of whether Session is read from or written to within that middleware) will reset the timeout. Note that this is independent of the cookie&#8217;s expiration.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><code class="docutils literal"><span class="pre">Session</span></code> is <em>non-locking</em>, so if two requests both attempt to modify the contents of session, the last one will win. Further, <code class="docutils literal"><span class="pre">Session</span></code> is implemented as a <em>coherent session</em>, which means that all of the contents are stored together. This means that if two requests are modifying different parts of the session (different keys), they may still impact each other.</p>
</div>
</div>
<div class="section" id="isession">
<h3>ISession<a class="headerlink" href="#isession" title="Permalink to this headline">Â¶</a></h3>
<p>Once session is installed and configured, you refer to it via HttpContext, which exposes a property called <code class="docutils literal"><span class="pre">Session</span></code> of type <a class="reference external" href="https://docs.asp.net/projects/api/en/latest/autoapi/Microsoft/AspNetCore/Http/Features/ISession/index.html">ISession</a>. You can use this interface to get and set values in <code class="docutils literal"><span class="pre">Session</span></code>, as <code class="docutils literal"><span class="pre">byte[]</span></code>.</p>
<div class="highlight-c#"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">interface</span> <span class="n">ISession</span>
<span class="p">{</span>
  <span class="n">Task</span> <span class="nf">LoadAsync</span><span class="p">();</span>
  <span class="n">Task</span> <span class="nf">CommitAsync</span><span class="p">();</span>
  <span class="kt">bool</span> <span class="nf">TryGetValue</span><span class="p">(</span><span class="kt">string</span> <span class="n">key</span><span class="p">,</span> <span class="k">out</span> <span class="kt">byte</span><span class="p">[]</span> <span class="k">value</span><span class="p">);</span>
  <span class="k">void</span> <span class="nf">Set</span><span class="p">(</span><span class="kt">string</span> <span class="n">key</span><span class="p">,</span> <span class="kt">byte</span><span class="p">[]</span> <span class="k">value</span><span class="p">);</span>
  <span class="k">void</span> <span class="nf">Remove</span><span class="p">(</span><span class="kt">string</span> <span class="n">key</span><span class="p">);</span>
  <span class="k">void</span> <span class="nf">Clear</span><span class="p">();</span>
  <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">Keys</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Because``Session`` is built on top of <code class="docutils literal"><span class="pre">IDistributedCache</span></code>, you must always serialize the object instances being stored. Thus, the interface works with <code class="docutils literal"><span class="pre">byte[]</span></code> not simply <code class="docutils literal"><span class="pre">object</span></code>. However, there are extension methods that make working with simple types such as <code class="docutils literal"><span class="pre">String</span></code> and <code class="docutils literal"><span class="pre">Int32</span></code> easier, as well as making it easier to get a byte[] value from session.</p>
<div class="highlight-c#"><div class="highlight"><pre><span></span><span class="c1">// session extension usage examples</span>
<span class="n">context</span><span class="p">.</span><span class="n">Session</span><span class="p">.</span><span class="n">SetInt32</span><span class="p">(</span><span class="s">&quot;key1&quot;</span><span class="p">,</span> <span class="m">123</span><span class="p">);</span>
<span class="kt">int?</span> <span class="n">val</span> <span class="p">=</span> <span class="n">context</span><span class="p">.</span><span class="n">Session</span><span class="p">.</span><span class="n">GetInt32</span><span class="p">(</span><span class="s">&quot;key1&quot;</span><span class="p">);</span>
<span class="n">context</span><span class="p">.</span><span class="n">Session</span><span class="p">.</span><span class="n">SetString</span><span class="p">(</span><span class="s">&quot;key2&quot;</span><span class="p">,</span> <span class="s">&quot;value&quot;</span><span class="p">);</span>
<span class="kt">string</span> <span class="n">stringVal</span> <span class="p">=</span> <span class="n">context</span><span class="p">.</span><span class="n">Session</span><span class="p">.</span><span class="n">GetString</span><span class="p">(</span><span class="s">&quot;key2&quot;</span><span class="p">);</span>
<span class="kt">byte</span><span class="p">[]</span> <span class="n">result</span> <span class="p">=</span> <span class="n">context</span><span class="p">.</span><span class="n">Session</span><span class="p">.</span><span class="n">Get</span><span class="p">(</span><span class="s">&quot;key3&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>If you&#8217;re storing more complex objects, you will need to serialize the object to a <code class="docutils literal"><span class="pre">byte[]</span></code> in order to store them, and then deserialize them from <code class="docutils literal"><span class="pre">byte[]</span></code> when retrieving them.</p>
</div>
</div>
<div class="section" id="a-working-sample-using-session">
<h2><a class="toc-backref" href="#id5">A Working Sample Using Session</a><a class="headerlink" href="#a-working-sample-using-session" title="Permalink to this headline">Â¶</a></h2>
<p>The associated sample application demonstrates how to work with Session, including storing and retrieving simple types as well as custom objects. In order to see what happens when session expires, the sample has configured sessions to last just 10 seconds:</p>
<div class="highlight-c#"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">void</span> <span class="nf">ConfigureServices</span><span class="p">(</span><span class="n">IServiceCollection</span> <span class="n">services</span><span class="p">)</span>
<span class="p">{</span>
<span class="hll">    <span class="n">services</span><span class="p">.</span><span class="n">AddCaching</span><span class="p">();</span>
</span>
<span class="hll">    <span class="n">services</span><span class="p">.</span><span class="n">AddSession</span><span class="p">(</span><span class="n">options</span> <span class="p">=&gt;</span>
</span><span class="hll">    <span class="p">{</span>
</span><span class="hll">        <span class="n">options</span><span class="p">.</span><span class="n">IdleTimeout</span> <span class="p">=</span> <span class="n">TimeSpan</span><span class="p">.</span><span class="n">FromSeconds</span><span class="p">(</span><span class="m">10</span><span class="p">);</span>
</span><span class="hll">    <span class="p">});</span>
</span><span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>When you first navigate to the web server, it displays a screen indicating that no session has yet been established:</p>
<img alt="../_images/no-session-established.png" src="../_images/no-session-established.png" />
<p>This default behavior is produced by the following middleware in <em>Startup.cs</em>, which runs when requests are made that do not already have an established session (note the highlighted sections):</p>
<div class="highlight-c#"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// main catchall middleware</span>
<span class="n">app</span><span class="p">.</span><span class="n">Run</span><span class="p">(</span><span class="k">async</span> <span class="n">context</span> <span class="p">=&gt;</span>
<span class="p">{</span>
<span class="hll">    <span class="n">RequestEntryCollection</span> <span class="n">collection</span> <span class="p">=</span> <span class="n">GetOrCreateEntries</span><span class="p">(</span><span class="n">context</span><span class="p">);</span>
</span>
<span class="hll">    <span class="k">if</span> <span class="p">(</span><span class="n">collection</span><span class="p">.</span><span class="n">TotalCount</span><span class="p">()</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span>
</span>    <span class="p">{</span>
<span class="hll">        <span class="k">await</span> <span class="n">context</span><span class="p">.</span><span class="n">Response</span><span class="p">.</span><span class="n">WriteAsync</span><span class="p">(</span><span class="s">&quot;&lt;html&gt;&lt;body&gt;&quot;</span><span class="p">);</span>
</span><span class="hll">        <span class="k">await</span> <span class="n">context</span><span class="p">.</span><span class="n">Response</span><span class="p">.</span><span class="n">WriteAsync</span><span class="p">(</span><span class="s">&quot;Your session has not been established.&lt;br&gt;&quot;</span><span class="p">);</span>
</span><span class="hll">        <span class="k">await</span> <span class="n">context</span><span class="p">.</span><span class="n">Response</span><span class="p">.</span><span class="n">WriteAsync</span><span class="p">(</span><span class="n">DateTime</span><span class="p">.</span><span class="n">Now</span><span class="p">.</span><span class="n">ToString</span><span class="p">()</span> <span class="p">+</span> <span class="s">&quot;&lt;br&gt;&quot;</span><span class="p">);</span>
</span><span class="hll">        <span class="k">await</span> <span class="n">context</span><span class="p">.</span><span class="n">Response</span><span class="p">.</span><span class="n">WriteAsync</span><span class="p">(</span><span class="s">&quot;&lt;a href=\&quot;/session\&quot;&gt;Establish session&lt;/a&gt;.&lt;br&gt;&quot;</span><span class="p">);</span>
</span>    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="n">collection</span><span class="p">.</span><span class="n">RecordRequest</span><span class="p">(</span><span class="n">context</span><span class="p">.</span><span class="n">Request</span><span class="p">.</span><span class="n">PathBase</span> <span class="p">+</span> <span class="n">context</span><span class="p">.</span><span class="n">Request</span><span class="p">.</span><span class="n">Path</span><span class="p">);</span>
        <span class="n">SaveEntries</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">collection</span><span class="p">);</span>

        <span class="c1">// Note: it&#39;s best to consistently perform all session access before writing anything to response</span>
        <span class="k">await</span> <span class="n">context</span><span class="p">.</span><span class="n">Response</span><span class="p">.</span><span class="n">WriteAsync</span><span class="p">(</span><span class="s">&quot;&lt;html&gt;&lt;body&gt;&quot;</span><span class="p">);</span>
        <span class="k">await</span> <span class="n">context</span><span class="p">.</span><span class="n">Response</span><span class="p">.</span><span class="n">WriteAsync</span><span class="p">(</span><span class="s">&quot;Session Established At: &quot;</span> <span class="p">+</span> <span class="n">context</span><span class="p">.</span><span class="n">Session</span><span class="p">.</span><span class="n">GetString</span><span class="p">(</span><span class="s">&quot;StartTime&quot;</span><span class="p">)</span> <span class="p">+</span> <span class="s">&quot;&lt;br&gt;&quot;</span><span class="p">);</span>
        <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">entry</span> <span class="k">in</span> <span class="n">collection</span><span class="p">.</span><span class="n">Entries</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">await</span> <span class="n">context</span><span class="p">.</span><span class="n">Response</span><span class="p">.</span><span class="n">WriteAsync</span><span class="p">(</span><span class="s">&quot;Request: &quot;</span> <span class="p">+</span> <span class="n">entry</span><span class="p">.</span><span class="n">Path</span> <span class="p">+</span> <span class="s">&quot; was requested &quot;</span> <span class="p">+</span> <span class="n">entry</span><span class="p">.</span><span class="n">Count</span> <span class="p">+</span> <span class="s">&quot; times.&lt;br /&gt;&quot;</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">await</span> <span class="n">context</span><span class="p">.</span><span class="n">Response</span><span class="p">.</span><span class="n">WriteAsync</span><span class="p">(</span><span class="s">&quot;Your session was located, you&#39;ve visited the site this many times: &quot;</span> <span class="p">+</span> <span class="n">collection</span><span class="p">.</span><span class="n">TotalCount</span><span class="p">()</span> <span class="p">+</span> <span class="s">&quot;&lt;br /&gt;&quot;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="hll">    <span class="k">await</span> <span class="n">context</span><span class="p">.</span><span class="n">Response</span><span class="p">.</span><span class="n">WriteAsync</span><span class="p">(</span><span class="s">&quot;&lt;a href=\&quot;/untracked\&quot;&gt;Visit untracked part of application&lt;/a&gt;.&lt;br&gt;&quot;</span><span class="p">);</span>
</span><span class="hll">    <span class="k">await</span> <span class="n">context</span><span class="p">.</span><span class="n">Response</span><span class="p">.</span><span class="n">WriteAsync</span><span class="p">(</span><span class="s">&quot;&lt;/body&gt;&lt;/html&gt;&quot;</span><span class="p">);</span>
</span></pre></div>
</td></tr></table></div>
<p><code class="docutils literal"><span class="pre">GetOrCreateEntries</span></code> is a helper method that will retrieve a <code class="docutils literal"><span class="pre">RequestEntryCollection</span></code> instance from <code class="docutils literal"><span class="pre">Session</span></code> if it exists; otherwise, it creates the empty collection and returns that. The collection holds <code class="docutils literal"><span class="pre">RequestEntry</span></code> instances, which keep track of the different requests the user has made during the current session, and how many requests they&#8217;ve made for each path.</p>
<div class="highlight-c#"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">class</span> <span class="nc">RequestEntry</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="n">Path</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">public</span> <span class="kt">int</span> <span class="n">Count</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<div class="highlight-c#"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">class</span> <span class="nc">RequestEntryCollection</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">RequestEntry</span><span class="p">&gt;</span> <span class="n">Entries</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">RequestEntry</span><span class="p">&gt;();</span>

    <span class="k">public</span> <span class="k">void</span> <span class="nf">RecordRequest</span><span class="p">(</span><span class="kt">string</span> <span class="n">requestPath</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">var</span> <span class="n">existingEntry</span> <span class="p">=</span> <span class="n">Entries</span><span class="p">.</span><span class="n">FirstOrDefault</span><span class="p">(</span><span class="n">e</span> <span class="p">=&gt;</span> <span class="n">e</span><span class="p">.</span><span class="n">Path</span> <span class="p">==</span> <span class="n">requestPath</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">existingEntry</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span> <span class="n">existingEntry</span><span class="p">.</span><span class="n">Count</span><span class="p">++;</span> <span class="k">return</span><span class="p">;</span> <span class="p">}</span>

        <span class="kt">var</span> <span class="n">newEntry</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RequestEntry</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">Path</span> <span class="p">=</span> <span class="n">requestPath</span><span class="p">,</span>
            <span class="n">Count</span> <span class="p">=</span> <span class="m">1</span>
        <span class="p">};</span>
        <span class="n">Entries</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">newEntry</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="kt">int</span> <span class="nf">TotalCount</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="n">Entries</span><span class="p">.</span><span class="n">Sum</span><span class="p">(</span><span class="n">e</span> <span class="p">=&gt;</span> <span class="n">e</span><span class="p">.</span><span class="n">Count</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The types that are to be stored in session must be marked with <code class="docutils literal"><span class="pre">[Serializable]</span></code>.</p>
</div>
<p>Fetching the current instance of <code class="docutils literal"><span class="pre">RequestEntryCollection</span></code> is done via the <code class="docutils literal"><span class="pre">GetOrCreateEntries</span></code> helper method:</p>
<div class="highlight-c#"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">private</span> <span class="n">RequestEntryCollection</span> <span class="nf">GetOrCreateEntries</span><span class="p">(</span><span class="n">HttpContext</span> <span class="n">context</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">RequestEntryCollection</span> <span class="n">collection</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
<span class="hll">    <span class="kt">byte</span><span class="p">[]</span> <span class="n">requestEntriesBytes</span> <span class="p">=</span> <span class="n">context</span><span class="p">.</span><span class="n">Session</span><span class="p">.</span><span class="n">Get</span><span class="p">(</span><span class="s">&quot;RequestEntries&quot;</span><span class="p">);</span>
</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">requestEntriesBytes</span> <span class="p">!=</span> <span class="k">null</span> <span class="p">&amp;&amp;</span> <span class="n">requestEntriesBytes</span><span class="p">.</span><span class="n">Length</span> <span class="p">&gt;</span> <span class="m">0</span><span class="p">)</span>
    <span class="p">{</span>
<span class="hll">        <span class="kt">string</span> <span class="n">json</span> <span class="p">=</span> <span class="n">System</span><span class="p">.</span><span class="n">Text</span><span class="p">.</span><span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">.</span><span class="n">GetString</span><span class="p">(</span><span class="n">requestEntriesBytes</span><span class="p">);</span>
</span><span class="hll">        <span class="k">return</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="n">DeserializeObject</span><span class="p">&lt;</span><span class="n">RequestEntryCollection</span><span class="p">&gt;(</span><span class="n">json</span><span class="p">);</span>
</span>    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">collection</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">collection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">RequestEntryCollection</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">collection</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>When the entry for the object exists in <code class="docutils literal"><span class="pre">Session</span></code>, it is retrieved as a <code class="docutils literal"><span class="pre">byte[]</span></code> type, and then deserialized using a <code class="docutils literal"><span class="pre">MemoryStream</span></code> and a <code class="docutils literal"><span class="pre">BinaryFormatter</span></code>, as shown above. If the object isn&#8217;t in <code class="docutils literal"><span class="pre">Session</span></code>, the method returns a new instance of the <code class="docutils literal"><span class="pre">RequestEntryCollection</span></code>.</p>
<p>In the browser, clicking the Establish session hyperlink makes a request to the path &#8220;/session&#8221;, and returns this result:</p>
<img alt="../_images/session-established.png" src="../_images/session-established.png" />
<p>Refreshing the page results in the count incrementing; returning to the root of the site (after making a few more requests) results in this display, summarizing all of the requests that were made during the current session:</p>
<img alt="../_images/session-established-with-request-counts.png" src="../_images/session-established-with-request-counts.png" />
<p>Establishing the session is done in the middleware that handles requests to &#8220;/session&#8221;:</p>
<div class="highlight-none"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class="code"><div class="highlight"><pre><span></span>// establish session
<span class="hll">app.Map(&quot;/session&quot;, subApp =&gt;
</span>{
    subApp.Run(async context =&gt;
    {
        // uncomment the following line and delete session coookie to generate an error due to session access after response has begun
        // await context.Response.WriteAsync(&quot;some content&quot;);
<span class="hll">        RequestEntryCollection collection = GetOrCreateEntries(context);
</span><span class="hll">        collection.RecordRequest(context.Request.PathBase + context.Request.Path);
</span><span class="hll">        SaveEntries(context, collection);
</span><span class="hll">        if (context.Session.GetString(&quot;StartTime&quot;) == null)
</span><span class="hll">        {
</span><span class="hll">            context.Session.SetString(&quot;StartTime&quot;, DateTime.Now.ToString());
</span><span class="hll">        }
</span>        await context.Response.WriteAsync(&quot;&lt;html&gt;&lt;body&gt;&quot;);
        await context.Response.WriteAsync($&quot;Counting: You have made {collection.TotalCount()} requests to this application.&lt;br&gt;&lt;a href=\&quot;/\&quot;&gt;Return&lt;/a&gt;&quot;);
        await context.Response.WriteAsync(&quot;&lt;/body&gt;&lt;/html&gt;&quot;);

    });
});
</pre></div>
</td></tr></table></div>
<p>Requests to this path will get or create a <code class="docutils literal"><span class="pre">RequestEntryCollection</span></code>, will add the current path to it, and then will store it in session using the helper method <code class="docutils literal"><span class="pre">SaveEntries</span></code>, shown below:</p>
<div class="highlight-c#"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">private</span> <span class="k">void</span> <span class="nf">SaveEntries</span><span class="p">(</span><span class="n">HttpContext</span> <span class="n">context</span><span class="p">,</span> <span class="n">RequestEntryCollection</span> <span class="n">collection</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">string</span> <span class="n">json</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="n">SerializeObject</span><span class="p">(</span><span class="n">collection</span><span class="p">);</span>
    <span class="kt">byte</span><span class="p">[]</span> <span class="n">serializedResult</span> <span class="p">=</span> <span class="n">System</span><span class="p">.</span><span class="n">Text</span><span class="p">.</span><span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">.</span><span class="n">GetBytes</span><span class="p">(</span><span class="n">json</span><span class="p">);</span>

<span class="hll">    <span class="n">context</span><span class="p">.</span><span class="n">Session</span><span class="p">.</span><span class="n">Set</span><span class="p">(</span><span class="s">&quot;RequestEntries&quot;</span><span class="p">,</span> <span class="n">serializedResult</span><span class="p">);</span>
</span><span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p><code class="docutils literal"><span class="pre">SaveEntries</span></code> demonstrates how to serialize a custom object into a <code class="docutils literal"><span class="pre">byte[]</span></code> for storage in <code class="docutils literal"><span class="pre">Session</span></code> using a <code class="docutils literal"><span class="pre">MemoryStream</span></code> and a <code class="docutils literal"><span class="pre">BinaryFormatter</span></code>.</p>
<p>The sample includes one more piece of middleware worth mentioning, which is mapped to the &#8220;/untracked&#8221; path. You can see its configuration here:</p>
<div class="highlight-c#"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// example middleware that does not reference session at all and is configured before app.UseSession()</span>
<span class="hll"><span class="n">app</span><span class="p">.</span><span class="n">Map</span><span class="p">(</span><span class="s">&quot;/untracked&quot;</span><span class="p">,</span> <span class="n">subApp</span> <span class="p">=&gt;</span>
</span><span class="p">{</span>
    <span class="n">subApp</span><span class="p">.</span><span class="n">Run</span><span class="p">(</span><span class="k">async</span> <span class="n">context</span> <span class="p">=&gt;</span>
    <span class="p">{</span>
        <span class="k">await</span> <span class="n">context</span><span class="p">.</span><span class="n">Response</span><span class="p">.</span><span class="n">WriteAsync</span><span class="p">(</span><span class="s">&quot;&lt;html&gt;&lt;body&gt;&quot;</span><span class="p">);</span>
        <span class="k">await</span> <span class="n">context</span><span class="p">.</span><span class="n">Response</span><span class="p">.</span><span class="n">WriteAsync</span><span class="p">(</span><span class="s">&quot;Requested at: &quot;</span> <span class="p">+</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">Now</span><span class="p">.</span><span class="n">ToString</span><span class="p">()</span> <span class="p">+</span> <span class="s">&quot;&lt;br&gt;&quot;</span><span class="p">);</span>
        <span class="k">await</span> <span class="n">context</span><span class="p">.</span><span class="n">Response</span><span class="p">.</span><span class="n">WriteAsync</span><span class="p">(</span><span class="s">&quot;This part of the application isn&#39;t referencing Session...&lt;br&gt;&lt;a href=\&quot;/\&quot;&gt;Return&lt;/a&gt;&quot;</span><span class="p">);</span>
        <span class="k">await</span> <span class="n">context</span><span class="p">.</span><span class="n">Response</span><span class="p">.</span><span class="n">WriteAsync</span><span class="p">(</span><span class="s">&quot;&lt;/body&gt;&lt;/html&gt;&quot;</span><span class="p">);</span>
    <span class="p">});</span>
<span class="p">});</span>

<span class="hll"><span class="n">app</span><span class="p">.</span><span class="n">UseSession</span><span class="p">();</span>
</span></pre></div>
</td></tr></table></div>
<p>Note that this middleware is configured <strong>before</strong> the call to <code class="docutils literal"><span class="pre">app.UseSession()</span></code> is made (on line 13). Thus, the <code class="docutils literal"><span class="pre">Session</span></code> feature is not available to this middleware, and requests made to it do not reset the session <code class="docutils literal"><span class="pre">IdleTimeout</span></code>. You can confirm this behavior in the sample application by refreshing the untracked path several times within 10 seconds, and then return to the application root. You will find that your session has expired, despite no more than 10 seconds having passed between your requests to the application.</p>
</div>
</div>



  
  <!-- Helpfulness -->
  <div id="helpful-position"></div>
  <div id="helpful" class="helpfulness-container" style="display:none;">
    <div class="helpfulness">
      <div class="helpfulness-form">
        <h2>Is this page helpful?</h2>
        <a id="helpfulness-btn-yes" href="javascript:;" class="common-btn first">Yes</a>
        <a id="helpfulness-btn-no" href="javascript:;" class="common-btn">No</a>
      </div>
      <div class="helpfulness-form-no" style="display:none;">
        <h2>Is this page helpful?</h2>
        Sorry this wasn't helpful.
        <input type="text" id="txt-helpfulness" placeholder="Please let us know why this wasn't helpful">
        <span id="helpfulness-characters-left">characters remaining</span>
        <a id="helpfulness-btn-submit" href="javascript:;" class="common-btn">Submit</a>
        <a id="helpfulness-btn-skip" href="javascript:;" class="common-btn secondary">Skip this</a>
      </div>
      <a href="javascript:;" class="helpfulness-close">âœ–</a>
      <div class="messages processing" style="display:none;">
        Sending feedback...
      </div>
      <div class="messages success" style="display:none;">
        Thank you for your feedback!
      </div>
      <div class="messages helpfulness-error" style="display:none;">
        Error during submission!
      </div>
    </div>
  </div>
  

  <!-- wedc -->
  <noscript>
    <img alt="" width="1" height="1" src="https://c.microsoft.com/trans_pixel.aspx"/>
  </noscript>

  
    <!-- disqus -->
    <button id="showComments" type="button" class="btn btn-neutral"><i class="fa fa-comment"></i> Show comments</button>
    <div id="disqus_thread"></div>
    <hr/>
  
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="servers.html" class="btn btn-neutral float-right" title="Servers" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="environments.html" class="btn btn-neutral" title="Working with Multiple Environments" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Microsoft.
      Last updated on Jun 21, 2016.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  Documentation licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>.


</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/helpfulness.js?v=6"></script>
      <script type="text/javascript" src="../_static/disqus.js?v=6"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>
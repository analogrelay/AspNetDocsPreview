

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Unit Testing &mdash; ASP.NET  documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/custom.css?v=6" type="text/css" />
  

  
    <link rel="top" title="ASP.NET  documentation" href="../index.html"/>
        <link rel="up" title="Testing" href="index.html"/>
        <link rel="next" title="Integration Testing" href="integration-testing.html"/>
        <link rel="prev" title="Testing" href="index.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> ASP.NET
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting-started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference external" href="https://docs.asp.net/projects/api">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../conceptual-overview/index.html">Conceptual Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fundamentals/index.html">Fundamentals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mvc/index.html">MVC</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Testing</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Unit Testing</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="integration-testing.html">Integration Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mvc/controllers/testing.html">Testing Controller Logic</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../data/index.html">Working with Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../client-side/index.html">Client-Side Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mobile/index.html">Mobile</a></li>
<li class="toctree-l1"><a class="reference internal" href="../publishing/index.html">Publishing and Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hosting/index.html">Guidance for Hosting Providers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../security/index.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../performance/index.html">Performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../migration/index.html">Migration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contribute/index.html">Contribute</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">ASP.NET</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="index.html">Testing</a> &raquo;</li>
      
    <li>Unit Testing</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/testing/unit-testing.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
  <div class="section" id="unit-testing">
<h1>Unit Testing<a class="headerlink" href="#unit-testing" title="Permalink to this headline">¶</a></h1>
<p>By <a class="reference external" href="http://ardalis.com">Steve Smith</a></p>
<p>ASP.NET Core has been designed with testability in mind, so that creating unit tests for your applications is easier than ever before. This article briefly introduces unit tests (and how they differ from other kinds of tests) and demonstrates how to add a test project to your solution and then run unit tests using either the command line or Visual Studio.</p>
<div class="contents local topic" id="sections">
<p class="topic-title first">Sections:</p>
<ul class="simple">
<li><a class="reference internal" href="#getting-started-with-testing" id="id2">Getting Started with Testing</a></li>
<li><a class="reference internal" href="#creating-test-projects" id="id3">Creating Test Projects</a></li>
<li><a class="reference internal" href="#running-tests" id="id4">Running Tests</a></li>
<li><a class="reference internal" href="#additional-resources" id="id5">Additional Resources</a></li>
</ul>
</div>
<p><a class="reference external" href="https://github.com/aspnet/Docs/tree/master/aspnet/testing/unit-testing/sample">View or download sample code</a></p>
<div class="section" id="getting-started-with-testing">
<h2><a class="toc-backref" href="#id2">Getting Started with Testing</a><a class="headerlink" href="#getting-started-with-testing" title="Permalink to this headline">¶</a></h2>
<p>Having a suite of automated tests is one of the best ways to ensure a software application does what its authors intended it to do. There are many different kinds of tests for software applications, including <a class="reference internal" href="integration-testing.html"><span class="doc">integration tests</span></a>, web tests, load tests, and many others. At the lowest level are unit tests, which test individual software components or methods. Unit tests should only test code within the developer&#8217;s control, and should not test infrastructure concerns, like databases, file systems, or network resources. Unit tests may be written using <a class="reference external" href="http://deviq.com/test-driven-development/">Test Driven Development (TDD)</a>, or they can be added to existing code to confirm its correctness. In either case, they should be small, well-named, and fast, since ideally you will want to be able to run hundreds of them before pushing your changes into the project&#8217;s shared code repository.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Developers often struggle with coming up with good names for their test classes and methods. As a starting point, the ASP.NET product team follows <a class="reference external" href="https://github.com/aspnet/Home/wiki/Engineering-guidelines#unit-tests-and-functional-tests">these conventions</a></p>
</div>
<p>When writing unit tests, be careful you don&#8217;t accidentally introduce dependencies on infrastructure. These tend to make tests slower and more brittle, and thus should be reserved for integration tests. You can avoid these hidden dependencies in your application code by following the <a class="reference external" href="http://deviq.com/explicit-dependencies-principle/">Explicit Dependencies Principle</a> and using <a class="reference internal" href="../fundamentals/dependency-injection.html"><span class="doc">Dependency Injection</span></a> to request your dependencies from the framework. You can also keep your unit tests in a separate project from your integration tests, and ensure your unit test project doesn&#8217;t have references to or dependencies on infrastructure packages.</p>
</div>
<div class="section" id="creating-test-projects">
<h2><a class="toc-backref" href="#id3">Creating Test Projects</a><a class="headerlink" href="#creating-test-projects" title="Permalink to this headline">¶</a></h2>
<p>A test project is just a class library with references to a test runner and the project being tested (also referred to as the System Under Test or SUT). It&#8217;s a good idea to organize your test projects in a separate folder from your SUT projects, and the recommended convention for ASP.NET Core projects is something like this:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">global</span><span class="o">.</span><span class="n">json</span>
<span class="n">PrimeWeb</span><span class="o">.</span><span class="n">sln</span>
<span class="n">src</span><span class="o">/</span>
  <span class="n">PrimeWeb</span><span class="o">/</span>
    <span class="n">project</span><span class="o">.</span><span class="n">json</span>
    <span class="n">Startup</span><span class="o">.</span><span class="n">cs</span>
    <span class="n">Services</span><span class="o">/</span>
      <span class="n">PrimeService</span><span class="o">.</span><span class="n">cs</span>
<span class="n">test</span><span class="o">/</span>
  <span class="n">PrimeWeb</span><span class="o">.</span><span class="n">UnitTests</span><span class="o">/</span>
    <span class="n">project</span><span class="o">.</span><span class="n">json</span>
    <span class="n">Services</span><span class="o">/</span>
      <span class="n">PrimeService_IsPrimeShould</span><span class="o">.</span><span class="n">cs</span>
</pre></div>
</div>
<p>It is important that there be a folder/directory with the name of the project you are testing (PrimeWeb above), since the file system is used to find your project.</p>
<div class="section" id="configuring-the-test-project-json">
<h3>Configuring the Test project.json<a class="headerlink" href="#configuring-the-test-project-json" title="Permalink to this headline">¶</a></h3>
<p>The test project&#8217;s <em>project.json</em> file should add dependencies on the test framework being used and the SUT project. For example, to work with the <a class="reference external" href="http://xunit.github.io/">xUnit test framework</a>, you would configure the dependencies as follows:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>&quot;dependencies&quot;: {
  &quot;PrimeWeb&quot;: &quot;1.0.0&quot;,
  &quot;xunit&quot;: &quot;2.1.0&quot;,
  &quot;dotnet-test-xunit&quot;: &quot;1.0.0-rc2-build10025&quot;
}
</pre></div>
</div>
<p>As other test frameworks release support for .NET Core, we will link to them here. We are simply using xUnit as one example of the many different testing frameworks that are available for .NET development.</p>
<p>In addition to adding dependencies, we also want to be able to run the tests using the <code class="docutils literal"><span class="pre">dotnet</span> <span class="pre">test</span></code>. To do so, add the following test runner section to <em>project.json</em>:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>},
&quot;dependencies&quot;: {
  &quot;PrimeWeb&quot;: &quot;1.0.0&quot;,
  &quot;xunit&quot;: &quot;2.1.0&quot;,
  &quot;dotnet-test-xunit&quot;: &quot;1.0.0-rc2-build10025&quot;
</pre></div>
</div>
</div>
</div>
<div class="section" id="running-tests">
<h2><a class="toc-backref" href="#id4">Running Tests</a><a class="headerlink" href="#running-tests" title="Permalink to this headline">¶</a></h2>
<p>Before you can run your tests, you&#8217;ll need to write some. For this demo, I&#8217;ve created a simple service that checks whether numbers are prime. One of the tests is shown here:</p>
<div class="highlight-c#"><div class="highlight"><pre><span></span><span class="na">[Theory]</span>
<span class="na">[InlineData(-1)]</span>
<span class="na">[InlineData(0)]</span>
<span class="na">[InlineData(1)]</span>
<span class="k">public</span> <span class="k">void</span> <span class="nf">ReturnFalseGivenValuesLessThan2</span><span class="p">(</span><span class="kt">int</span> <span class="k">value</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">_primeService</span><span class="p">.</span><span class="n">IsPrime</span><span class="p">(</span><span class="k">value</span><span class="p">);</span>

    <span class="n">Assert</span><span class="p">.</span><span class="n">False</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">String</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">&quot;{0} should not be prime&quot;</span><span class="p">,</span> <span class="k">value</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This test will check the values -1, 0, and 1 using the <code class="docutils literal"><span class="pre">IsPrime</span></code> method in each of three separate tests. Each test will pass if <code class="docutils literal"><span class="pre">IsPrime</span></code> returns false, and will otherwise fail.</p>
<p>You can run tests from the command line or using Visual Studio, whichever you prefer.</p>
<div class="section" id="visual-studio">
<h3>Visual Studio<a class="headerlink" href="#visual-studio" title="Permalink to this headline">¶</a></h3>
<p>To run tests in Visual Studio, first open the Test Explorer tab, then build the solution to have it discover all available tests. Once you have done so, you should see all of your tests in the Test Explorer window. Click Run All to run the tests and see the results.</p>
<img alt="../_images/test-explorer1.png" src="../_images/test-explorer1.png" />
<p>If you click the icon in the top-left, Visual Studio will run tests after every build, providing immediate feedback as you work on your application.</p>
</div>
<div class="section" id="command-line">
<h3>Command Line<a class="headerlink" href="#command-line" title="Permalink to this headline">¶</a></h3>
<p>To run tests from the command line, navigate to your unit test project folder. Next, run:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">dotnet</span> <span class="n">test</span>
</pre></div>
</div>
<p>You should see output similar to the following:</p>
<img alt="../_images/dnx-test.png" src="../_images/dnx-test.png" />
</div>
<div class="section" id="dotnet-watch">
<h3>dotnet watch<a class="headerlink" href="#dotnet-watch" title="Permalink to this headline">¶</a></h3>
<p>You can use the <code class="docutils literal"><span class="pre">dotnet</span> <span class="pre">watch</span></code> tool to automatically execute a command whenever the contents of the folder change. This can be used to automatically run tests whenever files are saved in the project. Note that it will detect changes to both the SUT project and the test project, even when run from the test project folder.</p>
<p>To use <code class="docutils literal"><span class="pre">dotnet</span> <span class="pre">watch</span></code>, simply run it and pass it the command argument you would otherwise have passed to <code class="docutils literal"><span class="pre">dotnet</span></code>. In this case:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">dotnet</span> <span class="n">watch</span> <span class="n">test</span>
</pre></div>
</div>
<p>With <code class="docutils literal"><span class="pre">dotnet</span> <span class="pre">watch</span></code> running, you can make updates to your tests and/or your application, and upon saving your changes you should see the tests run again, as shown here:</p>
<img alt="../_images/dnx-watch.png" src="../_images/dnx-watch.png" />
<p>One of the major benefits of automated testing is the rapid feedback tests provide, reducing the time between the introduction of a bug and its discovery. With continuously running tests, whether using <code class="docutils literal"><span class="pre">dotnet</span> <span class="pre">watch</span></code> or Visual Studio, developers can almost immediately discover when they&#8217;ve introduced behavior that breaks existing expectations about how the application should behave.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">View the <a class="reference external" href="https://github.com/aspnet/docs/tree/master/aspnet/testing/unit-testing/sample">sample</a> to see the complete set of tests and service behavior. You can run the web application and navigate to <code class="docutils literal"><span class="pre">/checkprime?5</span></code> to test whether numbers are prime. You can learn more about testing and refactoring this checkprime web behavior in <a class="reference internal" href="integration-testing.html"><span class="doc">Integration Testing</span></a>.</p>
</div>
</div>
</div>
<div class="section" id="additional-resources">
<h2><a class="toc-backref" href="#id5">Additional Resources</a><a class="headerlink" href="#additional-resources" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference internal" href="integration-testing.html"><span class="doc">Integration Testing</span></a></li>
<li><a class="reference internal" href="../fundamentals/dependency-injection.html"><span class="doc">Dependency Injection</span></a></li>
</ul>
</div>
</div>



  
  <!-- Helpfulness -->
  <div id="helpful-position"></div>
  <div id="helpful" class="helpfulness-container" style="display:none;">
    <div class="helpfulness">
      <div class="helpfulness-form">
        <h2>Is this page helpful?</h2>
        <a id="helpfulness-btn-yes" href="javascript:;" class="common-btn first">Yes</a>
        <a id="helpfulness-btn-no" href="javascript:;" class="common-btn">No</a>
      </div>
      <div class="helpfulness-form-no" style="display:none;">
        <h2>Is this page helpful?</h2>
        Sorry this wasn't helpful.
        <input type="text" id="txt-helpfulness" placeholder="Please let us know why this wasn't helpful">
        <span id="helpfulness-characters-left">characters remaining</span>
        <a id="helpfulness-btn-submit" href="javascript:;" class="common-btn">Submit</a>
        <a id="helpfulness-btn-skip" href="javascript:;" class="common-btn secondary">Skip this</a>
      </div>
      <a href="javascript:;" class="helpfulness-close">✖</a>
      <div class="messages processing" style="display:none;">
        Sending feedback...
      </div>
      <div class="messages success" style="display:none;">
        Thank you for your feedback!
      </div>
      <div class="messages helpfulness-error" style="display:none;">
        Error during submission!
      </div>
    </div>
  </div>
  

  <!-- wedc -->
  <noscript>
    <img alt="" width="1" height="1" src="https://c.microsoft.com/trans_pixel.aspx"/>
  </noscript>

  
    <!-- disqus -->
    <button id="showComments" type="button" class="btn btn-neutral"><i class="fa fa-comment"></i> Show comments</button>
    <div id="disqus_thread"></div>
    <hr/>
  
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="integration-testing.html" class="btn btn-neutral float-right" title="Integration Testing" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Testing" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Microsoft.
      Last updated on Jun 21, 2016.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  Documentation licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>.


</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/helpfulness.js?v=6"></script>
      <script type="text/javascript" src="../_static/disqus.js?v=6"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>
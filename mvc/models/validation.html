

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Model Validation &mdash; ASP.NET  documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../_static/custom.css?v=6" type="text/css" />
  

  
    <link rel="top" title="ASP.NET  documentation" href="../../index.html"/>
        <link rel="up" title="Models" href="index.html"/>
        <link rel="next" title="ðŸ”§ Formatting" href="formatting.html"/>
        <link rel="prev" title="Model Binding" href="model-binding.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> ASP.NET
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../getting-started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference external" href="https://docs.asp.net/projects/api">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../conceptual-overview/index.html">Conceptual Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fundamentals/index.html">Fundamentals</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">MVC</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../overview.html">ðŸ”§ Overview of ASP.NET MVC</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Models</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="model-binding.html">Model Binding</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Model Validation</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="formatting.html">ðŸ”§ Formatting</a></li>
<li class="toctree-l3"><a class="reference internal" href="custom-formatters.html">ðŸ”§ Custom Formatters</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../views/index.html">Views</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/index.html">Controllers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../testing/index.html">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data/index.html">Working with Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../client-side/index.html">Client-Side Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mobile/index.html">Mobile</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../publishing/index.html">Publishing and Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hosting/index.html">Guidance for Hosting Providers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../security/index.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../performance/index.html">Performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../migration/index.html">Migration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contribute/index.html">Contribute</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">ASP.NET</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../index.html">MVC</a> &raquo;</li>
      
          <li><a href="index.html">Models</a> &raquo;</li>
      
    <li>Model Validation</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/mvc/models/validation.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
  <div class="section" id="model-validation">
<h1>Model Validation<a class="headerlink" href="#model-validation" title="Permalink to this headline">Â¶</a></h1>
<p>By <a class="reference external" href="http://github.com/rachelappel">Rachel Appel</a></p>
<p>In this article:</p>
<div class="contents local topic" id="sections">
<p class="topic-title first">Sections</p>
<ul class="simple">
<li><a class="reference internal" href="#introduction-to-model-validation" id="id2">Introduction to model validation</a></li>
<li><a class="reference internal" href="#validation-attributes" id="id3">Validation Attributes</a></li>
<li><a class="reference internal" href="#model-state" id="id4">Model State</a></li>
<li><a class="reference internal" href="#manual-validation" id="id5">Manual validation</a></li>
<li><a class="reference internal" href="#custom-validation" id="id6">Custom validation</a></li>
<li><a class="reference internal" href="#client-side-validation" id="id7">Client side validation</a></li>
<li><a class="reference internal" href="#iclientmodelvalidator" id="id8">IClientModelValidator</a></li>
<li><a class="reference internal" href="#remote-validation" id="id9">Remote validation</a></li>
</ul>
</div>
<div class="section" id="introduction-to-model-validation">
<h2><a class="toc-backref" href="#id2">Introduction to model validation</a><a class="headerlink" href="#introduction-to-model-validation" title="Permalink to this headline">Â¶</a></h2>
<p>Before an app stores data in a database, the app must validate the data. Data must be checked for potential security threats, verified that it is appropriately formatted by type and size, and it must conform to your rules. Validation is necessary although it can be redundant and tedious to implement. In MVC, validation happens on both the client and server.</p>
<p>Fortunately, .NET has abstracted validation into validation attributes. These attributes contain validation code, thereby reducing the amount of code you must write.</p>
</div>
<div class="section" id="validation-attributes">
<h2><a class="toc-backref" href="#id3">Validation Attributes</a><a class="headerlink" href="#validation-attributes" title="Permalink to this headline">Â¶</a></h2>
<p>Validation attributes are a way to configure model validation so it&#8217;s similar conceptually to validation on fields in database tables. This includes constraints such as assigning data types or required fields. Other types of validation include applying patterns to data to enforce business rules, such as a credit card, phone number, or email address. Validation attributes make enforcing these requirements much simpler and easier to use.</p>
<p>Below is an annotated <code class="docutils literal"><span class="pre">Movie</span></code> model from an app that stores information about movies and TV shows. Most of the properties are required and several string properties have length requirements. Additionally, there is a numeric range restriction in place for the <code class="docutils literal"><span class="pre">Price</span></code> property from 0 to $999.99, along with a custom validation attribute.</p>
<div class="highlight-c#"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">class</span> <span class="nc">Movie</span>   
<span class="p">{</span>
    <span class="k">public</span> <span class="kt">int</span> <span class="n">Id</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

<span class="na">    [Required]</span>
<span class="na">    [StringLength(100)]</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="n">Title</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

<span class="na">    [Required]</span>
<span class="na">    [ClassicMovie(1960)]</span>
    <span class="k">public</span> <span class="n">DateTime</span> <span class="n">ReleaseDate</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
<span class="na">    </span>
<span class="na">    [Required]</span>
<span class="na">    [StringLength(1000)]</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="n">Description</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

<span class="na">    [Required]</span>
<span class="na">    [Range(0, 999.99)]</span>        
    <span class="k">public</span> <span class="kt">decimal</span> <span class="n">Price</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
<span class="na">    </span>
<span class="na">    [Required]</span>
    <span class="k">public</span> <span class="n">Genre</span> <span class="n">Genre</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

    <span class="k">public</span> <span class="kt">bool</span> <span class="n">Preorder</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

<span class="na">    [Required]</span>
    <span class="k">public</span> <span class="n">Audience</span> <span class="n">Audience</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">public</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Review</span><span class="p">&gt;</span> <span class="n">Reviews</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>  
<span class="p">}</span>
</pre></div>
</div>
<p>Simply reading through the model reveals the rules about data for this app, making it easier to maintain the code. Below are several popular built-in validation attributes:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">[CreditCard]</span></code>: Validates the property has a credit card format.</li>
<li><code class="docutils literal"><span class="pre">[Compare]</span></code>: Validates two properties in a model match.</li>
<li><code class="docutils literal"><span class="pre">[EmailAddress]</span></code>: Validates the property has an email format.</li>
<li><code class="docutils literal"><span class="pre">[Phone]</span></code>: Validates the property has a telephone format.</li>
<li><code class="docutils literal"><span class="pre">[Range]</span></code>: Validates the property value falls within the given range.</li>
<li><code class="docutils literal"><span class="pre">[RegularExpression]</span></code>: Validates that the data matches the specified regular expression.</li>
<li><code class="docutils literal"><span class="pre">[Required]</span></code>: Makes a property required.</li>
<li><code class="docutils literal"><span class="pre">[StringLength]</span></code>: Validates that a string property has at most the given maximum length.</li>
<li><code class="docutils literal"><span class="pre">[Url]</span></code>: Validates the property has a URL format.</li>
</ul>
<p>MVC supports any attribute that derives from <code class="docutils literal"><span class="pre">ValidationAttribute</span></code> for validation purposes. Many useful validation attributes can be found in the <a class="reference external" href="https://msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations(v=vs.110).aspx">System.ComponentModel.DataAnnotations</a> namespace.</p>
<p>There may be instances where you need more features than built-in attributes provide. For those times, you can create custom validation attributes by deriving from <code class="docutils literal"><span class="pre">ValidationAttribute</span></code> or change your model to subclass <code class="docutils literal"><span class="pre">IValidatableObject</span></code>.</p>
</div>
<div class="section" id="model-state">
<h2><a class="toc-backref" href="#id4">Model State</a><a class="headerlink" href="#model-state" title="Permalink to this headline">Â¶</a></h2>
<p>Model state represents validation errors that were submitted with HTML form values.</p>
<p>MVC will continue validating fields until reaches the maximum number of errors (200 by default). You can configure this number by inserting the following code into the <code class="docutils literal"><span class="pre">ConfigureServices</span></code> method in the <code class="docutils literal"><span class="pre">Startup.cs</span></code> file:</p>
<div class="highlight-c#"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">class</span> <span class="nc">Startup</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">ConfigureServices</span><span class="p">(</span><span class="n">IServiceCollection</span> <span class="n">services</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">services</span><span class="p">.</span><span class="n">Configure</span><span class="p">&lt;</span><span class="n">MvcOptions</span><span class="p">&gt;(</span><span class="n">options</span> <span class="p">=&gt;</span>
        <span class="p">{</span>
            <span class="n">options</span><span class="p">.</span><span class="n">MaxModelValidationErrors</span> <span class="p">=</span> <span class="m">50</span><span class="p">;</span>
        <span class="p">});</span>           
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="manual-validation">
<h2><a class="toc-backref" href="#id5">Manual validation</a><a class="headerlink" href="#manual-validation" title="Permalink to this headline">Â¶</a></h2>
<p>After model binding and validation are complete, you may want to repeat parts of it. For example, a user may have entered text in a field expecting an integer, or you may need to compute a value for a model&#8217;s property.</p>
<p>You may need to run validation manually. To do so, call the <code class="docutils literal"><span class="pre">TryValidateModel</span></code> method, as shown here:</p>
<div class="highlight-c#"><div class="highlight"><pre><span></span><span class="n">TryValidateModel</span><span class="p">(</span><span class="n">movie</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="custom-validation">
<h2><a class="toc-backref" href="#id6">Custom validation</a><a class="headerlink" href="#custom-validation" title="Permalink to this headline">Â¶</a></h2>
<p>Validation attributes work for most validation needs. However, some validation rules are specific to your business, as they&#8217;re not just generic data validation such as ensuring a field is required or that it conforms to a range of values. For these scenarios, custom validation attributes are a great solution. Creating your own custom validation attributes in MVC is easy. Just inherit from the <code class="docutils literal"><span class="pre">ValidationAttribute</span></code>, and override the <code class="docutils literal"><span class="pre">IsValid</span></code> method. The <code class="docutils literal"><span class="pre">IsValid</span></code> method accepts two parameters, the first is an object named <cite>value</cite> and the second is a <code class="docutils literal"><span class="pre">ValidationContext</span></code> object named <cite>validationContext</cite>. <cite>Value</cite> refers to the actual value from the field that your custom validator is validating.</p>
<p>In the following sample, a business rule that states that users may not set the genre to <cite>Classic</cite> for a movie released after 1960. The <code class="docutils literal"><span class="pre">[ClassicMovie]</span></code> attribute checks the genre first, and if it is a classic, then it checks the release date to see that it is later than 1960. If it is released after 1960, validation fails. The attribute accepts an integer parameter representing the year that you can use to validate data. You can capture the value of the parameter in the attribute&#8217;s constructor, as shown here:</p>
<div class="highlight-c#"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">class</span> <span class="nc">ClassicMovieAttribute</span> <span class="p">:</span> <span class="n">ValidationAttribute</span><span class="p">,</span> <span class="n">IClientModelValidator</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="kt">int</span> <span class="n">_year</span><span class="p">;</span>
    <span class="k">public</span> <span class="nf">ClassicMovieAttribute</span><span class="p">(</span><span class="kt">int</span> <span class="n">Year</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">_year</span> <span class="p">=</span> <span class="n">Year</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">protected</span> <span class="k">override</span> <span class="n">ValidationResult</span> <span class="nf">IsValid</span><span class="p">(</span><span class="kt">object</span> <span class="k">value</span><span class="p">,</span> <span class="n">ValidationContext</span> <span class="n">validationContext</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Movie</span> <span class="n">movie</span> <span class="p">=</span> <span class="p">(</span><span class="n">Movie</span><span class="p">)</span><span class="n">validationContext</span><span class="p">.</span><span class="n">ObjectInstance</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">movie</span><span class="p">.</span><span class="n">Genre</span> <span class="p">==</span> <span class="n">Genre</span><span class="p">.</span><span class="n">Classic</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">movie</span><span class="p">.</span><span class="n">ReleaseDate</span><span class="p">.</span><span class="n">Year</span> <span class="p">&lt;</span> <span class="n">_year</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">return</span> <span class="k">new</span> <span class="nf">ValidationResult</span><span class="p">(</span>
                    <span class="s">&quot;Classic movies must have a release year earlier than &quot;</span> <span class="p">+</span> <span class="k">this</span><span class="p">.</span><span class="n">_year</span><span class="p">);</span>

            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">ValidationResult</span><span class="p">.</span><span class="n">Success</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">ModelClientValidationRule</span><span class="p">&gt;</span>
    <span class="n">GetClientValidationRules</span><span class="p">(</span><span class="n">ClientModelValidationContext</span> <span class="n">context</span><span class="p">)</span>
    <span class="p">{</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">movie</span></code> variable above represents a <code class="docutils literal"><span class="pre">Movie</span></code> object that contains the data from the form submission to validate. In this case, the validation code checks the date and genre in the <code class="docutils literal"><span class="pre">IsValid</span></code> method of the <code class="docutils literal"><span class="pre">ClassicMovieAttribute</span></code> class as per the rules. Upon successful validation <code class="docutils literal"><span class="pre">IsValid</span></code> returns a <code class="docutils literal"><span class="pre">ValidationResult.Success</span></code> code, and when validation fails, a <code class="docutils literal"><span class="pre">ValidationResult</span></code> with an error message. When a user modifies the <code class="docutils literal"><span class="pre">Genre</span></code> field and submits the form, the <code class="docutils literal"><span class="pre">IsValid</span></code> method of the <code class="docutils literal"><span class="pre">ClassicMovieAttribute</span></code> will verify whether the movie is a classic. Like any built-in attribute, apply the <code class="docutils literal"><span class="pre">ClassicMovieAttribute</span></code> to a property such as <code class="docutils literal"><span class="pre">ReleaseDate</span></code> to ensure validation happens, as shown in the previous code sample. Since the example works only with <code class="docutils literal"><span class="pre">Movie</span></code> types, a better option is to use <code class="docutils literal"><span class="pre">IValidatableObject</span></code> as shown in the following paragraph.</p>
<p>Alternatively, this same code could be placed in the model instead by implementing the <code class="docutils literal"><span class="pre">Validate</span></code> method on the <code class="docutils literal"><span class="pre">IValidatableObject</span></code> interface. While custom validation attributes work well for validating individual properties, implementing <code class="docutils literal"><span class="pre">IValidatableObject</span></code> can be used to implement class-level validation as seen here.</p>
<blockquote>
<div><div class="highlight-c#"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">ValidationResult</span><span class="p">&gt;</span> 
    <span class="n">Validate</span><span class="p">(</span><span class="n">ValidationContext</span> <span class="n">validationContext</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">Genre</span> <span class="p">==</span> <span class="n">Genre</span><span class="p">.</span><span class="n">Classic</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">ReleaseDate</span><span class="p">.</span><span class="n">Year</span> <span class="p">&gt;</span> <span class="n">_classicYear</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">yield</span> <span class="k">return</span> <span class="k">new</span> <span class="nf">ValidationResult</span><span class="p">(</span>
                <span class="s">&quot;Classic movies must have a release year earlier than &quot;</span> <span class="p">+</span> <span class="n">_classicYear</span><span class="p">,</span> 
                <span class="k">new</span><span class="p">[]</span> <span class="p">{</span> <span class="s">&quot;ReleaseDate&quot;</span> <span class="p">});</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="client-side-validation">
<h2><a class="toc-backref" href="#id7">Client side validation</a><a class="headerlink" href="#client-side-validation" title="Permalink to this headline">Â¶</a></h2>
<p>Client side validation is a great convenience for users. It saves time they would otherwise spend waiting for a round trip to the server. In business terms, even a few fractions of seconds multiplied hundreds of times each day adds up to be a lot of time, expense, and frustration. Straightforward and immediate validation enables users to work more efficiently and produce better quality input and output.</p>
<p>You must have a view with the proper JavaScript script references in place for client side validation to work as you see here.</p>
<div class="highlight-html"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;~/lib/jquery/jquery.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;~/lib/jquery-validation/dist/jquery.validate.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;~/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>MVC uses validation attributes in addition to type metadata from model properties to validate data and display any error messages using JavaScript. When you use MVC to render form elements from a model using <a class="reference external" href="https://docs.asp.net/en/latest/mvc/views/tag-helpers/index.html">Tag Helpers</a> or <a class="reference external" href="https://docs.asp.net/en/latest/mvc/views/html-helpers.html">HTML helpers</a> it will add HTML 5 <a class="reference external" href="http://w3c.github.io/html/dom.html#embedding-custom-non-visible-data-with-the-data-attributes">data- attributes</a> in the form elements that need validation, as shown below. MVC generates the <code class="docutils literal"><span class="pre">data-</span></code> attributes for both built-in and custom attributes. The <code class="docutils literal"><span class="pre">data-val-required</span></code> attribute below contains an error message to display if the user doesn&#8217;t fill in the release date field, and that message displays in the accompanying <code class="docutils literal"><span class="pre">&lt;span&gt;</span></code> element. You can display validation errors on the client using the relevant tag helpers as shown here:</p>
<div class="highlight-html"><div class="highlight"><pre><span></span> <span class="p">&lt;</span><span class="nt">form</span> <span class="na">asp-action</span><span class="o">=</span><span class="s">&quot;Create&quot;</span><span class="p">&gt;</span>
   <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-horizontal&quot;</span><span class="p">&gt;</span>
     <span class="p">&lt;</span><span class="nt">h4</span><span class="p">&gt;</span>Movie<span class="p">&lt;/</span><span class="nt">h4</span><span class="p">&gt;</span>
       <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-group&quot;</span><span class="p">&gt;</span>
         <span class="p">&lt;</span><span class="nt">label</span> <span class="na">asp-for</span><span class="o">=</span><span class="s">&quot;ReleaseDate&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;col-md-2 control-label&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
         <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;col-md-10&quot;</span><span class="p">&gt;</span>
<span class="hll">           <span class="p">&lt;</span><span class="nt">input</span> <span class="na">asp-for</span><span class="o">=</span><span class="s">&quot;ReleaseDate&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span> <span class="p">/&gt;</span>
</span><span class="hll">           <span class="p">&lt;</span><span class="nt">span</span> <span class="na">asp-validation-for</span><span class="o">=</span><span class="s">&quot;ReleaseDate&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-danger&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
</span>         <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
     <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
   <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
 <span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>The tag helpers above render the HTML below. Notice that the <code class="docutils literal"><span class="pre">data-</span></code> attributes in the HTML output correspond to the validation attributes for the <code class="docutils literal"><span class="pre">ReleaseDate</span></code> property.</p>
<div class="highlight-html"><div class="highlight"><pre><span></span> <span class="p">&lt;</span><span class="nt">form</span> <span class="na">action</span><span class="o">=</span><span class="s">&quot;/movies/Create&quot;</span> <span class="na">method</span><span class="o">=</span><span class="s">&quot;post&quot;</span><span class="p">&gt;</span>
   <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-horizontal&quot;</span><span class="p">&gt;</span>
     <span class="p">&lt;</span><span class="nt">h4</span><span class="p">&gt;</span>Movie<span class="p">&lt;/</span><span class="nt">h4</span><span class="p">&gt;</span>
     <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-danger&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
     <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-group&quot;</span><span class="p">&gt;</span>
       <span class="p">&lt;</span><span class="nt">label</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;col-md-2 control-label&quot;</span> <span class="na">for</span><span class="o">=</span><span class="s">&quot;ReleaseDate&quot;</span><span class="p">&gt;</span>ReleaseDate<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
       <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;col-md-10&quot;</span><span class="p">&gt;</span>
<span class="hll">         <span class="p">&lt;</span><span class="nt">input</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;datetime&quot;</span>
</span><span class="hll">         <span class="na">data-val</span><span class="o">=</span><span class="s">&quot;true&quot;</span> <span class="na">data-val-required</span><span class="o">=</span><span class="s">&quot;The ReleaseDate field is required.&quot;</span>
</span><span class="hll">         <span class="na">id</span><span class="o">=</span><span class="s">&quot;ReleaseDate&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;ReleaseDate&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;&quot;</span> <span class="p">/&gt;</span>
</span><span class="hll">         <span class="p">&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-danger field-validation-valid&quot;</span>
</span><span class="hll">         <span class="na">data-valmsg-for</span><span class="o">=</span><span class="s">&quot;ReleaseDate&quot;</span> <span class="na">data-valmsg-replace</span><span class="o">=</span><span class="s">&quot;true&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
</span>       <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
     <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
     <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
 <span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>Client-side validation prevents submission until the form is valid. The Submit button runs JavaScript that either submits the form or displays error messages.</p>
<p>MVC determines type attribute values based on the .NET data type of a property, possibly overridden using <code class="docutils literal"><span class="pre">[DataType]</span></code> attributes. The base <code class="docutils literal"><span class="pre">[DataType]</span></code> attribute does no real server-side validation. Browsers choose their own error messages and display those errors however they wish, however the jQuery Validation Unobtrusive package can override the messages and display them consistently with others. This happens most obviously when users apply <code class="docutils literal"><span class="pre">[DataType]</span></code> subclasses such as <code class="docutils literal"><span class="pre">[EmailAddress]</span></code>.</p>
</div>
<div class="section" id="iclientmodelvalidator">
<h2><a class="toc-backref" href="#id8">IClientModelValidator</a><a class="headerlink" href="#iclientmodelvalidator" title="Permalink to this headline">Â¶</a></h2>
<p>You may create client side logic for your custom attribute, and <a class="reference external" href="http://jqueryvalidation.org/documentation/">unobtrusive validation</a> will execute it on the client for you automatically as part of validation. The first step is to control what data- attributes are added by implementing the <code class="docutils literal"><span class="pre">IClientModelValidator</span></code> interface as shown here:</p>
<div class="highlight-c#"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">class</span> <span class="nc">ClassicMovieAttribute</span> <span class="p">:</span> <span class="n">ValidationAttribute</span><span class="p">,</span> <span class="n">IClientModelValidator</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="kt">int</span> <span class="n">_year</span><span class="p">;</span>
    <span class="k">public</span> <span class="nf">ClassicMovieAttribute</span><span class="p">(</span><span class="kt">int</span> <span class="n">Year</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">_year</span> <span class="p">=</span> <span class="n">Year</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">protected</span> <span class="k">override</span> <span class="n">ValidationResult</span> <span class="nf">IsValid</span><span class="p">(</span><span class="kt">object</span> <span class="k">value</span><span class="p">,</span> <span class="n">ValidationContext</span> <span class="n">validationContext</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Movie</span> <span class="n">movie</span> <span class="p">=</span> <span class="p">(</span><span class="n">Movie</span><span class="p">)</span><span class="n">validationContext</span><span class="p">.</span><span class="n">ObjectInstance</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">movie</span><span class="p">.</span><span class="n">Genre</span> <span class="p">==</span> <span class="n">Genre</span><span class="p">.</span><span class="n">Classic</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">movie</span><span class="p">.</span><span class="n">ReleaseDate</span><span class="p">.</span><span class="n">Year</span> <span class="p">&lt;</span> <span class="n">_year</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">return</span> <span class="k">new</span> <span class="nf">ValidationResult</span><span class="p">(</span>
                    <span class="s">&quot;Classic movies must have a release year earlier than &quot;</span> <span class="p">+</span> <span class="k">this</span><span class="p">.</span><span class="n">_year</span><span class="p">);</span>

            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">ValidationResult</span><span class="p">.</span><span class="n">Success</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">ModelClientValidationRule</span><span class="p">&gt;</span>
    <span class="n">GetClientValidationRules</span><span class="p">(</span><span class="n">ClientModelValidationContext</span> <span class="n">context</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">yield</span> <span class="k">return</span> <span class="k">new</span> <span class="nf">ModelClientValidationRule</span><span class="p">(</span><span class="s">&quot;classicmovie&quot;</span><span class="p">,</span> 
            <span class="s">&quot;Classic movies must have a release year earlier than &quot;</span> <span class="p">+</span> <span class="k">this</span><span class="p">.</span><span class="n">_year</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Attributes that implement this interface can add HTML attributes to generated fields. Examining the output for the <code class="docutils literal"><span class="pre">ReleaseDate</span></code> element reveals HTML that is similar to the previous example, except now there is a <code class="docutils literal"><span class="pre">data-val-classicmovie</span></code> attribute that was defined in the <code class="docutils literal"><span class="pre">GetClientValidationRules</span></code> method of <code class="docutils literal"><span class="pre">IClientModelValidator</span></code>.</p>
<div class="highlight-html"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">input</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;datetime&quot;</span>
<span class="na">data-val</span><span class="o">=</span><span class="s">&quot;true&quot;</span>
<span class="na">data-val-classicmovie</span><span class="o">=</span><span class="s">&quot;Classic movies must have a release year earlier than 1960&quot;</span>
<span class="na">data-val-required</span><span class="o">=</span><span class="s">&quot;The ReleaseDate field is required.&quot;</span>
<span class="na">id</span><span class="o">=</span><span class="s">&quot;ReleaseDate&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;ReleaseDate&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;&quot;</span> <span class="p">/&gt;</span>
</pre></div>
</div>
<p>Unobtrusive validation uses the data in the <code class="docutils literal"><span class="pre">data-</span></code> attributes to display error messages. However, jQuery doesn&#8217;t know about rules or messages until you add them to jQuery&#8217;s <code class="docutils literal"><span class="pre">validator</span></code> object. This is shown in the example below that adds a method named <code class="docutils literal"><span class="pre">classicmovie</span></code> containing custom client validation code to the jQuery <code class="docutils literal"><span class="pre">validator</span></code> object.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">$</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">jQuery</span><span class="p">.</span><span class="nx">validator</span><span class="p">.</span><span class="nx">addMethod</span><span class="p">(</span><span class="s1">&#39;classicmovie&#39;</span><span class="p">,</span>
    <span class="kd">function</span> <span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">element</span><span class="p">,</span> <span class="nx">params</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// custom validation code</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">},</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>

    <span class="nx">jQuery</span><span class="p">.</span><span class="nx">validator</span><span class="p">.</span><span class="nx">unobtrusive</span><span class="p">.</span><span class="nx">adapters</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">&#39;classicmovie&#39;</span><span class="p">,</span>
    <span class="kd">function</span> <span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">options</span><span class="p">.</span><span class="nx">rules</span><span class="p">[</span><span class="s1">&#39;classicmovie&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{};</span>
        <span class="nx">options</span><span class="p">.</span><span class="nx">messages</span><span class="p">[</span><span class="s1">&#39;classicmovie&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">message</span><span class="p">;</span>
    <span class="p">});</span>
<span class="p">}(</span><span class="nx">jQuery</span><span class="p">));</span>
</pre></div>
</div>
<p>Now jQuery has the information to execute the custom JavaScript validation as well as the error message to display if that validation code returns false.</p>
</div>
<div class="section" id="remote-validation">
<h2><a class="toc-backref" href="#id9">Remote validation</a><a class="headerlink" href="#remote-validation" title="Permalink to this headline">Â¶</a></h2>
<p>Remote validation is a great feature to use when you need to validate data on the client against data on the server. For example, your app may need to verify whether an email or user name is already in use, and it must query a large amount of data to do so. Downloading large sets of data for validating one or a few fields consumes too many resources. It may also expose sensitive information. An alternative is to make a round-trip request to validate a field.</p>
<p>You can implement remote validation in a two step process. First, you must annotate your model with the <code class="docutils literal"><span class="pre">[Remote]</span></code> attribute. The <code class="docutils literal"><span class="pre">[Remote]</span></code> attribute accepts multiple overloads you can use to direct client side JavaScript to the appropriate code to call. The example points to the <code class="docutils literal"><span class="pre">VerifyEmail</span></code> action method of the <code class="docutils literal"><span class="pre">Users</span></code> controller.</p>
<div class="highlight-c#"><div class="highlight"><pre><span></span>    <span class="k">public</span> <span class="k">class</span> <span class="nc">UserRepository</span> <span class="p">:</span> <span class="n">IUserRepository</span>
    <span class="p">{</span>
<span class="na">        [Remote(action: &quot;VerifyEmail&quot;, controller: &quot;Users&quot;)]</span>
        <span class="k">public</span> <span class="kt">string</span> <span class="n">Email</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

        <span class="k">public</span> <span class="kt">bool</span> <span class="nf">VerifyEmail</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="c1">// in the real world this would actually verify the email</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">NotImplementedException</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The second step is putting the validation code in the corresponding action method as defined in the <code class="docutils literal"><span class="pre">[Remote]</span></code> attribute. It returns a <code class="docutils literal"><span class="pre">JsonResult</span></code> that the client side can use to proceed or pause and display an error if needed.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>    public class UsersController : Controller
    {
        private IUserRepository userRepo;
        public UsersController()
        {
            this.userRepo = new UserRepository();
        }

        [AcceptVerbs(&quot;Get&quot;, &quot;Post&quot;)]
        public IActionResult VerifyEmail(string email)
        {
            if (!this.userRepo.VerifyEmail())
            {
                return Json(data: $&quot;Email {email} is already in use.&quot;);
            }

            return Json(data: true);
        }
</pre></div>
</div>
<p>Now when users enter an email, JavaScript in the view makes a remote call to see if that email has been taken, and if so, then displays the error message. Otherwise, the user can submit the form as usual.</p>
</div>
</div>



  
  <!-- Helpfulness -->
  <div id="helpful-position"></div>
  <div id="helpful" class="helpfulness-container" style="display:none;">
    <div class="helpfulness">
      <div class="helpfulness-form">
        <h2>Is this page helpful?</h2>
        <a id="helpfulness-btn-yes" href="javascript:;" class="common-btn first">Yes</a>
        <a id="helpfulness-btn-no" href="javascript:;" class="common-btn">No</a>
      </div>
      <div class="helpfulness-form-no" style="display:none;">
        <h2>Is this page helpful?</h2>
        Sorry this wasn't helpful.
        <input type="text" id="txt-helpfulness" placeholder="Please let us know why this wasn't helpful">
        <span id="helpfulness-characters-left">characters remaining</span>
        <a id="helpfulness-btn-submit" href="javascript:;" class="common-btn">Submit</a>
        <a id="helpfulness-btn-skip" href="javascript:;" class="common-btn secondary">Skip this</a>
      </div>
      <a href="javascript:;" class="helpfulness-close">âœ–</a>
      <div class="messages processing" style="display:none;">
        Sending feedback...
      </div>
      <div class="messages success" style="display:none;">
        Thank you for your feedback!
      </div>
      <div class="messages helpfulness-error" style="display:none;">
        Error during submission!
      </div>
    </div>
  </div>
  

  <!-- wedc -->
  <noscript>
    <img alt="" width="1" height="1" src="https://c.microsoft.com/trans_pixel.aspx"/>
  </noscript>

  
    <!-- disqus -->
    <button id="showComments" type="button" class="btn btn-neutral"><i class="fa fa-comment"></i> Show comments</button>
    <div id="disqus_thread"></div>
    <hr/>
  
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="formatting.html" class="btn btn-neutral float-right" title="ðŸ”§ Formatting" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="model-binding.html" class="btn btn-neutral" title="Model Binding" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Microsoft.
      Last updated on Jun 21, 2016.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  Documentation licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>.


</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="../../_static/helpfulness.js?v=6"></script>
      <script type="text/javascript" src="../../_static/disqus.js?v=6"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Injecting Services Into Views &mdash; ASP.NET  documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../_static/custom.css?v=6" type="text/css" />
  

  
    <link rel="top" title="ASP.NET  documentation" href="../../index.html"/>
        <link rel="up" title="Views" href="index.html"/>
        <link rel="next" title="View Components" href="view-components.html"/>
        <link rel="prev" title="Partial Views" href="partial.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> ASP.NET
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../getting-started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference external" href="https://docs.asp.net/projects/api">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../conceptual-overview/index.html">Conceptual Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fundamentals/index.html">Fundamentals</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">MVC</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../overview.html">ðŸ”§ Overview of ASP.NET MVC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/index.html">Models</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Views</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="razor.html">ðŸ”§ Razor Syntax</a></li>
<li class="toctree-l3"><a class="reference internal" href="layout.html">Layout</a></li>
<li class="toctree-l3"><a class="reference internal" href="dynamic-vs-static.html">ðŸ”§ Dynamic vs Strongly Typed Views</a></li>
<li class="toctree-l3"><a class="reference internal" href="working-with-forms.html">Working with Forms</a></li>
<li class="toctree-l3"><a class="reference internal" href="html-helpers.html">ðŸ”§ HTML Helpers</a></li>
<li class="toctree-l3"><a class="reference internal" href="tag-helpers/index.html">Tag Helpers</a></li>
<li class="toctree-l3"><a class="reference internal" href="partial.html">Partial Views</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Injecting Services Into Views</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="view-components.html">View Components</a></li>
<li class="toctree-l3"><a class="reference internal" href="custom-view-engine.html">ðŸ”§ Creating a Custom View Engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="mobile.html">ðŸ”§ Building Mobile Specific Views</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/index.html">Controllers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../testing/index.html">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data/index.html">Working with Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../client-side/index.html">Client-Side Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mobile/index.html">Mobile</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../publishing/index.html">Publishing and Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hosting/index.html">Guidance for Hosting Providers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../security/index.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../performance/index.html">Performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../migration/index.html">Migration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contribute/index.html">Contribute</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">ASP.NET</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../index.html">MVC</a> &raquo;</li>
      
          <li><a href="index.html">Views</a> &raquo;</li>
      
    <li>Injecting Services Into Views</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/mvc/views/dependency-injection.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
  <div class="section" id="injecting-services-into-views">
<h1>Injecting Services Into Views<a class="headerlink" href="#injecting-services-into-views" title="Permalink to this headline">Â¶</a></h1>
<p>By <a class="reference external" href="http://ardalis.com">Steve Smith</a></p>
<p>ASP.NET Core supports <a class="reference internal" href="../../fundamentals/dependency-injection.html"><span class="doc">dependency injection</span></a> into views. This can be useful for view-specific services, such as localization or data required only for populating view elements. You should try to maintain <a class="reference external" href="http://deviq.com/separation-of-concerns">separation of concerns</a> between your controllers and views. Most of the data your views display should be passed in from the controller.</p>
<div class="contents local topic" id="sections">
<p class="topic-title first">Sections:</p>
<ul class="simple">
<li><a class="reference internal" href="#a-simple-example" id="id1">A Simple Example</a></li>
<li><a class="reference internal" href="#populating-lookup-data" id="id2">Populating Lookup Data</a></li>
<li><a class="reference internal" href="#overriding-services" id="id3">Overriding Services</a></li>
<li><a class="reference internal" href="#see-also" id="id4">See Also</a></li>
</ul>
</div>
<p><a class="reference external" href="https://github.com/aspnet/Docs/tree/master/aspnet/mvc/views/dependency-injection/sample">View or download sample code</a></p>
<div class="section" id="a-simple-example">
<h2><a class="toc-backref" href="#id1">A Simple Example</a><a class="headerlink" href="#a-simple-example" title="Permalink to this headline">Â¶</a></h2>
<p>You can inject a service into a view using the <code class="docutils literal"><span class="pre">&#64;inject</span></code> directive. You can think of <code class="docutils literal"><span class="pre">&#64;inject</span></code> as adding a property to your view, and populating the property using DI.</p>
<dl class="docutils">
<dt>The syntax for <code class="docutils literal"><span class="pre">&#64;inject</span></code>:</dt>
<dd><code class="docutils literal"><span class="pre">&#64;inject</span> <span class="pre">&lt;type&gt;</span> <span class="pre">&lt;name&gt;</span></code></dd>
</dl>
<p>An example of <code class="docutils literal"><span class="pre">&#64;inject</span></code> in action:</p>
<div class="highlight-c#"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">@using</span> <span class="n">System</span><span class="p">.</span><span class="n">Threading</span><span class="p">.</span><span class="n">Tasks</span>
<span class="n">@using</span> <span class="n">ViewInjectSample</span><span class="p">.</span><span class="n">Model</span>
<span class="n">@using</span> <span class="n">ViewInjectSample</span><span class="p">.</span><span class="n">Model</span><span class="p">.</span><span class="n">Services</span>
<span class="hll"><span class="n">@model</span> <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">ToDoItem</span><span class="p">&gt;</span>
</span><span class="hll"><span class="n">@inject</span> <span class="n">StatisticsService</span> <span class="n">StatsService</span>
</span><span class="p">&lt;!</span><span class="n">DOCTYPE</span> <span class="n">html</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="n">html</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="n">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="n">title</span><span class="p">&gt;</span><span class="n">To</span> <span class="n">Do</span> <span class="n">Items</span><span class="p">&lt;/</span><span class="n">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="n">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="n">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="n">div</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="n">h1</span><span class="p">&gt;</span><span class="n">To</span> <span class="n">Do</span> <span class="n">Items</span><span class="p">&lt;/</span><span class="n">h1</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="n">ul</span><span class="p">&gt;</span>
<span class="hll">            <span class="p">&lt;</span><span class="n">li</span><span class="p">&gt;</span><span class="n">Total</span> <span class="n">Items</span><span class="p">:</span> <span class="n">@await</span> <span class="n">StatsService</span><span class="p">.</span><span class="n">GetCount</span><span class="p">()&lt;/</span><span class="n">li</span><span class="p">&gt;</span>
</span><span class="hll">            <span class="p">&lt;</span><span class="n">li</span><span class="p">&gt;</span><span class="n">Completed</span><span class="p">:</span> <span class="n">@await</span> <span class="n">StatsService</span><span class="p">.</span><span class="n">GetCompletedCount</span><span class="p">()&lt;/</span><span class="n">li</span><span class="p">&gt;</span>
</span><span class="hll">            <span class="p">&lt;</span><span class="n">li</span><span class="p">&gt;</span><span class="n">Avg</span><span class="p">.</span> <span class="n">Priority</span><span class="p">:</span> <span class="n">@await</span> <span class="n">StatsService</span><span class="p">.</span><span class="n">GetAveragePriority</span><span class="p">()&lt;/</span><span class="n">li</span><span class="p">&gt;</span>
</span>        <span class="p">&lt;/</span><span class="n">ul</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="n">table</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="n">tr</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="n">th</span><span class="p">&gt;</span><span class="n">Name</span><span class="p">&lt;/</span><span class="n">th</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="n">th</span><span class="p">&gt;</span><span class="n">Priority</span><span class="p">&lt;/</span><span class="n">th</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="n">th</span><span class="p">&gt;</span><span class="n">Is</span> <span class="n">Done</span><span class="p">?&lt;/</span><span class="n">th</span><span class="p">&gt;</span>
            <span class="p">&lt;/</span><span class="n">tr</span><span class="p">&gt;</span>
            <span class="n">@foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">item</span> <span class="k">in</span> <span class="n">Model</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="p">&lt;</span><span class="n">tr</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="n">td</span><span class="p">&gt;</span><span class="n">@item</span><span class="p">.</span><span class="n">Name</span><span class="p">&lt;/</span><span class="n">td</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="n">td</span><span class="p">&gt;</span><span class="n">@item</span><span class="p">.</span><span class="n">Priority</span><span class="p">&lt;/</span><span class="n">td</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="n">td</span><span class="p">&gt;</span><span class="n">@item</span><span class="p">.</span><span class="n">IsDone</span><span class="p">&lt;/</span><span class="n">td</span><span class="p">&gt;</span>
                <span class="p">&lt;/</span><span class="n">tr</span><span class="p">&gt;</span>
            <span class="p">}</span>
        <span class="p">&lt;/</span><span class="n">table</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="n">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="n">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="n">html</span><span class="p">&gt;</span>
</pre></div>
</td></tr></table></div>
<p>This view displays a list of <code class="docutils literal"><span class="pre">ToDoItem</span></code> instances, along with a summary showing overall statistics. The summary is populated from the injected <code class="docutils literal"><span class="pre">StatisticsService</span></code>. This service is registered for dependency injection in <code class="docutils literal"><span class="pre">ConfigureServices</span></code> in <em>Startup.cs</em>:</p>
<div class="highlight-c#"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// For more information on how to configure your application, visit http://go.microsoft.com/fwlink/?LinkID=398940</span>
<span class="k">public</span> <span class="k">void</span> <span class="nf">ConfigureServices</span><span class="p">(</span><span class="n">IServiceCollection</span> <span class="n">services</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">services</span><span class="p">.</span><span class="n">AddMvc</span><span class="p">();</span>

<span class="hll">    <span class="n">services</span><span class="p">.</span><span class="n">AddTransient</span><span class="p">&lt;</span><span class="n">IToDoItemRepository</span><span class="p">,</span> <span class="n">ToDoItemRepository</span><span class="p">&gt;();</span>
</span><span class="hll">    <span class="n">services</span><span class="p">.</span><span class="n">AddTransient</span><span class="p">&lt;</span><span class="n">StatisticsService</span><span class="p">&gt;();</span>
</span>    <span class="n">services</span><span class="p">.</span><span class="n">AddTransient</span><span class="p">&lt;</span><span class="n">ProfileOptionsService</span><span class="p">&gt;();</span>
</pre></div>
</td></tr></table></div>
<p>The <code class="docutils literal"><span class="pre">StatisticsService</span></code> performs some calculations on the set of <code class="docutils literal"><span class="pre">ToDoItem</span></code> instances, which it accesses via a repository:</p>
<div class="highlight-c#"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="nn">System.Linq</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Threading.Tasks</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">ViewInjectSample.Interfaces</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ViewInjectSample.Model.Services</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">StatisticsService</span>
    <span class="p">{</span>
        <span class="k">private</span> <span class="k">readonly</span> <span class="n">IToDoItemRepository</span> <span class="n">_toDoItemRepository</span><span class="p">;</span>

        <span class="k">public</span> <span class="nf">StatisticsService</span><span class="p">(</span><span class="n">IToDoItemRepository</span> <span class="n">toDoItemRepository</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">_toDoItemRepository</span> <span class="p">=</span> <span class="n">toDoItemRepository</span><span class="p">;</span>
        <span class="p">}</span>

<span class="hll">        <span class="k">public</span> <span class="k">async</span> <span class="n">Task</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span> <span class="n">GetCount</span><span class="p">()</span>
</span>        <span class="p">{</span>
            <span class="k">return</span> <span class="k">await</span> <span class="n">Task</span><span class="p">.</span><span class="n">FromResult</span><span class="p">(</span><span class="n">_toDoItemRepository</span><span class="p">.</span><span class="n">List</span><span class="p">().</span><span class="n">Count</span><span class="p">());</span>
        <span class="p">}</span>

<span class="hll">        <span class="k">public</span> <span class="k">async</span> <span class="n">Task</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span> <span class="n">GetCompletedCount</span><span class="p">()</span>
</span>        <span class="p">{</span>
            <span class="k">return</span> <span class="k">await</span> <span class="n">Task</span><span class="p">.</span><span class="n">FromResult</span><span class="p">(</span>
              <span class="n">_toDoItemRepository</span><span class="p">.</span><span class="n">List</span><span class="p">().</span><span class="n">Count</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">IsDone</span><span class="p">));</span>
        <span class="p">}</span>

<span class="hll">        <span class="k">public</span> <span class="k">async</span> <span class="n">Task</span><span class="p">&lt;</span><span class="kt">double</span><span class="p">&gt;</span> <span class="n">GetAveragePriority</span><span class="p">()</span>
</span>        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">_toDoItemRepository</span><span class="p">.</span><span class="n">List</span><span class="p">().</span><span class="n">Count</span><span class="p">()</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">return</span> <span class="m">0.0</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="k">return</span> <span class="k">await</span> <span class="n">Task</span><span class="p">.</span><span class="n">FromResult</span><span class="p">(</span>
              <span class="n">_toDoItemRepository</span><span class="p">.</span><span class="n">List</span><span class="p">().</span><span class="n">Average</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">Priority</span><span class="p">));</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>The sample repository uses an in-memory collection. The implementation shown above (which operates on all of the data in memory) is not recommended for large, remotely accessed data sets.</p>
<p>The sample displays data from the model bound to the view and the service injected into the view:</p>
<img alt="../../_images/screenshot.png" src="../../_images/screenshot.png" />
</div>
<div class="section" id="populating-lookup-data">
<h2><a class="toc-backref" href="#id2">Populating Lookup Data</a><a class="headerlink" href="#populating-lookup-data" title="Permalink to this headline">Â¶</a></h2>
<p>View injection can be useful to populate options in UI elements, such as dropdown lists. Consider a user profile form that includes options for specifying gender, state, and other preferences. Rendering such a form using a standard MVC approach would require the controller to request data access services for each of these sets of options, and then populate a model or <code class="docutils literal"><span class="pre">ViewBag</span></code> with each set of options to be bound.</p>
<p>An alternative approach injects services directly into the view to obtain the options. This minimizes the amount of code required by the controller, moving this view element construction logic into the view itself. The controller action to display a profile editing form only needs to pass the form the profile instance:</p>
<div class="highlight-c#"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="nn">Microsoft.AspNet.Mvc</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">ViewInjectSample.Model</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ViewInjectSample.Controllers</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">ProfileController</span> <span class="p">:</span> <span class="n">Controller</span>
    <span class="p">{</span>
<span class="na">        [Route(&quot;Profile&quot;)]</span>
<span class="hll">        <span class="k">public</span> <span class="n">IActionResult</span> <span class="nf">Index</span><span class="p">()</span>
</span>        <span class="p">{</span>
            <span class="c1">// TODO: look up profile based on logged-in user</span>
            <span class="kt">var</span> <span class="n">profile</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Profile</span><span class="p">()</span>
            <span class="p">{</span>
                <span class="n">Name</span> <span class="p">=</span> <span class="s">&quot;Steve&quot;</span><span class="p">,</span>
                <span class="n">FavColor</span> <span class="p">=</span> <span class="s">&quot;Blue&quot;</span><span class="p">,</span>
                <span class="n">Gender</span> <span class="p">=</span> <span class="s">&quot;Male&quot;</span><span class="p">,</span>
                <span class="n">State</span> <span class="p">=</span> <span class="k">new</span> <span class="n">State</span><span class="p">(</span><span class="s">&quot;Ohio&quot;</span><span class="p">,</span><span class="s">&quot;OH&quot;</span><span class="p">)</span>
            <span class="p">};</span>
<span class="hll">            <span class="k">return</span> <span class="nf">View</span><span class="p">(</span><span class="n">profile</span><span class="p">);</span>
</span>        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>The HTML form used to update these preferences includes dropdown lists for three of the properties:</p>
<img alt="../../_images/updateprofile.png" src="../../_images/updateprofile.png" />
<p>These lists are populated by a service that has been injected into the view:</p>
<div class="highlight-c#"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">@using</span> <span class="n">System</span><span class="p">.</span><span class="n">Threading</span><span class="p">.</span><span class="n">Tasks</span>
<span class="n">@using</span> <span class="n">ViewInjectSample</span><span class="p">.</span><span class="n">Model</span><span class="p">.</span><span class="n">Services</span>
<span class="n">@model</span> <span class="n">ViewInjectSample</span><span class="p">.</span><span class="n">Model</span><span class="p">.</span><span class="n">Profile</span>
<span class="hll"><span class="n">@inject</span> <span class="n">ProfileOptionsService</span> <span class="n">Options</span>
</span><span class="p">&lt;!</span><span class="n">DOCTYPE</span> <span class="n">html</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="n">html</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="n">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="n">title</span><span class="p">&gt;</span><span class="n">Update</span> <span class="n">Profile</span><span class="p">&lt;/</span><span class="n">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="n">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="n">body</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="n">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="n">h1</span><span class="p">&gt;</span><span class="n">Update</span> <span class="n">Profile</span><span class="p">&lt;/</span><span class="n">h1</span><span class="p">&gt;</span>
    <span class="n">Name</span><span class="p">:</span> <span class="n">@Html</span><span class="p">.</span><span class="n">TextBoxFor</span><span class="p">(</span><span class="n">m</span> <span class="p">=&gt;</span> <span class="n">m</span><span class="p">.</span><span class="n">Name</span><span class="p">)</span>
    <span class="p">&lt;</span><span class="n">br</span><span class="p">/&gt;</span>
    <span class="n">Gender</span><span class="p">:</span> <span class="n">@Html</span><span class="p">.</span><span class="n">DropDownList</span><span class="p">(</span><span class="s">&quot;Gender&quot;</span><span class="p">,</span>
<span class="hll">           <span class="n">Options</span><span class="p">.</span><span class="n">ListGenders</span><span class="p">().</span><span class="n">Select</span><span class="p">(</span><span class="n">g</span> <span class="p">=&gt;</span> 
</span><span class="hll">                <span class="k">new</span> <span class="nf">SelectListItem</span><span class="p">()</span> <span class="p">{</span> <span class="n">Text</span> <span class="p">=</span> <span class="n">g</span><span class="p">,</span> <span class="n">Value</span> <span class="p">=</span> <span class="n">g</span> <span class="p">}))</span>
</span>    <span class="p">&lt;</span><span class="n">br</span><span class="p">/&gt;</span>

    <span class="n">State</span><span class="p">:</span> <span class="n">@Html</span><span class="p">.</span><span class="n">DropDownListFor</span><span class="p">(</span><span class="n">m</span> <span class="p">=&gt;</span> <span class="n">m</span><span class="p">.</span><span class="n">State</span><span class="p">.</span><span class="n">Code</span><span class="p">,</span>
<span class="hll">           <span class="n">Options</span><span class="p">.</span><span class="n">ListStates</span><span class="p">().</span><span class="n">Select</span><span class="p">(</span><span class="n">s</span> <span class="p">=&gt;</span> 
</span><span class="hll">                <span class="k">new</span> <span class="nf">SelectListItem</span><span class="p">()</span> <span class="p">{</span> <span class="n">Text</span> <span class="p">=</span> <span class="n">s</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span> <span class="n">Value</span> <span class="p">=</span> <span class="n">s</span><span class="p">.</span><span class="n">Code</span><span class="p">}))</span>
</span>    <span class="p">&lt;</span><span class="n">br</span> <span class="p">/&gt;</span>

    <span class="n">Fav</span><span class="p">.</span> <span class="n">Color</span><span class="p">:</span> <span class="n">@Html</span><span class="p">.</span><span class="n">DropDownList</span><span class="p">(</span><span class="s">&quot;FavColor&quot;</span><span class="p">,</span>
<span class="hll">           <span class="n">Options</span><span class="p">.</span><span class="n">ListColors</span><span class="p">().</span><span class="n">Select</span><span class="p">(</span><span class="n">c</span> <span class="p">=&gt;</span> 
</span><span class="hll">                <span class="k">new</span> <span class="nf">SelectListItem</span><span class="p">()</span> <span class="p">{</span> <span class="n">Text</span> <span class="p">=</span> <span class="n">c</span><span class="p">,</span> <span class="n">Value</span> <span class="p">=</span> <span class="n">c</span> <span class="p">}))</span>
</span>    <span class="p">&lt;/</span><span class="n">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="n">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="n">html</span><span class="p">&gt;</span>
</pre></div>
</td></tr></table></div>
<p>The <code class="docutils literal"><span class="pre">ProfileOptionsService</span></code> is a UI-level service designed to provide just the data needed for this form:</p>
<div class="highlight-c#"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ViewInjectSample.Model.Services</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">ProfileOptionsService</span>
    <span class="p">{</span>
<span class="hll">        <span class="k">public</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">ListGenders</span><span class="p">()</span>
</span>        <span class="p">{</span>
            <span class="c1">// keeping this simple</span>
            <span class="k">return</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;()</span> <span class="p">{</span><span class="s">&quot;Female&quot;</span><span class="p">,</span> <span class="s">&quot;Male&quot;</span><span class="p">};</span>
        <span class="p">}</span>

<span class="hll">        <span class="k">public</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">State</span><span class="p">&gt;</span> <span class="n">ListStates</span><span class="p">()</span>
</span>        <span class="p">{</span>
            <span class="c1">// a few states from USA</span>
            <span class="k">return</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">State</span><span class="p">&gt;()</span>
            <span class="p">{</span>
                <span class="k">new</span> <span class="nf">State</span><span class="p">(</span><span class="s">&quot;Alabama&quot;</span><span class="p">,</span> <span class="s">&quot;AL&quot;</span><span class="p">),</span>
                <span class="k">new</span> <span class="nf">State</span><span class="p">(</span><span class="s">&quot;Alaska&quot;</span><span class="p">,</span> <span class="s">&quot;AK&quot;</span><span class="p">),</span>
                <span class="k">new</span> <span class="nf">State</span><span class="p">(</span><span class="s">&quot;Ohio&quot;</span><span class="p">,</span> <span class="s">&quot;OH&quot;</span><span class="p">)</span>
            <span class="p">};</span>
        <span class="p">}</span>

<span class="hll">        <span class="k">public</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">ListColors</span><span class="p">()</span>
</span>        <span class="p">{</span>
            <span class="k">return</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;()</span> <span class="p">{</span> <span class="s">&quot;Blue&quot;</span><span class="p">,</span><span class="s">&quot;Green&quot;</span><span class="p">,</span><span class="s">&quot;Red&quot;</span><span class="p">,</span><span class="s">&quot;Yellow&quot;</span> <span class="p">};</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">Don&#8217;t forget to register types you will request through dependency injection in the  <code class="docutils literal"><span class="pre">ConfigureServices</span></code> method in <em>Startup.cs</em>.</p>
</div>
</div>
<div class="section" id="overriding-services">
<h2><a class="toc-backref" href="#id3">Overriding Services</a><a class="headerlink" href="#overriding-services" title="Permalink to this headline">Â¶</a></h2>
<p>In addition to injecting new services, this technique can also be used to override previously injected services on a page. The figure below shows all of the fields available on the page used in the first example:</p>
<img alt="../../_images/razor-fields.png" src="../../_images/razor-fields.png" />
<p>As you can see, the default fields include <code class="docutils literal"><span class="pre">Html</span></code>, <code class="docutils literal"><span class="pre">Component</span></code>, and <code class="docutils literal"><span class="pre">Url</span></code> (as well as the <code class="docutils literal"><span class="pre">StatsService</span></code> that we injected). If for instance you wanted to replace the default HTML Helpers with your own, you could easily do so using <code class="docutils literal"><span class="pre">&#64;inject</span></code>:</p>
<div class="highlight-html"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span></span>@using System.Threading.Tasks
@using ViewInjectSample.Helpers
@inject MyHtmlHelper Html
<span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="hll"><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
</span><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>My Helper<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
        Test: @Html.Value
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="hll"><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</span><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</td></tr></table></div>
<p>If you want to extend existing services, you can simply use this technique while inheriting from or wrapping the existing implementation with your own.</p>
</div>
<div class="section" id="see-also">
<h2><a class="toc-backref" href="#id4">See Also</a><a class="headerlink" href="#see-also" title="Permalink to this headline">Â¶</a></h2>
<ul class="simple">
<li>Simon Timms Blog: <a class="reference external" href="http://blog.simontimms.com/2015/06/09/getting-lookup-data-into-you-view/">Getting Lookup Data Into Your View</a></li>
</ul>
</div>
</div>



  
  <!-- Helpfulness -->
  <div id="helpful-position"></div>
  <div id="helpful" class="helpfulness-container" style="display:none;">
    <div class="helpfulness">
      <div class="helpfulness-form">
        <h2>Is this page helpful?</h2>
        <a id="helpfulness-btn-yes" href="javascript:;" class="common-btn first">Yes</a>
        <a id="helpfulness-btn-no" href="javascript:;" class="common-btn">No</a>
      </div>
      <div class="helpfulness-form-no" style="display:none;">
        <h2>Is this page helpful?</h2>
        Sorry this wasn't helpful.
        <input type="text" id="txt-helpfulness" placeholder="Please let us know why this wasn't helpful">
        <span id="helpfulness-characters-left">characters remaining</span>
        <a id="helpfulness-btn-submit" href="javascript:;" class="common-btn">Submit</a>
        <a id="helpfulness-btn-skip" href="javascript:;" class="common-btn secondary">Skip this</a>
      </div>
      <a href="javascript:;" class="helpfulness-close">âœ–</a>
      <div class="messages processing" style="display:none;">
        Sending feedback...
      </div>
      <div class="messages success" style="display:none;">
        Thank you for your feedback!
      </div>
      <div class="messages helpfulness-error" style="display:none;">
        Error during submission!
      </div>
    </div>
  </div>
  

  <!-- wedc -->
  <noscript>
    <img alt="" width="1" height="1" src="https://c.microsoft.com/trans_pixel.aspx"/>
  </noscript>

  
    <!-- disqus -->
    <button id="showComments" type="button" class="btn btn-neutral"><i class="fa fa-comment"></i> Show comments</button>
    <div id="disqus_thread"></div>
    <hr/>
  
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="view-components.html" class="btn btn-neutral float-right" title="View Components" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="partial.html" class="btn btn-neutral" title="Partial Views" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Microsoft.
      Last updated on Jun 21, 2016.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  Documentation licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>.


</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="../../_static/helpfulness.js?v=6"></script>
      <script type="text/javascript" src="../../_static/disqus.js?v=6"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>
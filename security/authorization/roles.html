

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Role based Authorization &mdash; ASP.NET  documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../_static/custom.css?v=6" type="text/css" />
  

  
    <link rel="top" title="ASP.NET  documentation" href="../../index.html"/>
        <link rel="up" title="Authorization" href="index.html"/>
        <link rel="next" title="Claims-Based Authorization" href="claims.html"/>
        <link rel="prev" title="Simple Authorization" href="simple.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> ASP.NET
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../getting-started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference external" href="https://docs.asp.net/projects/api">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../conceptual-overview/index.html">Conceptual Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fundamentals/index.html">Fundamentals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mvc/index.html">MVC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../testing/index.html">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data/index.html">Working with Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../client-side/index.html">Client-Side Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mobile/index.html">Mobile</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../publishing/index.html">Publishing and Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hosting/index.html">Guidance for Hosting Providers</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Security</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../authentication/index.html">Authentication</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Authorization</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="simple.html">Simple Authorization</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Role based Authorization</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="claims.html">Claims-Based Authorization</a></li>
<li class="toctree-l3"><a class="reference internal" href="policies.html">Custom Policy-Based Authorization</a></li>
<li class="toctree-l3"><a class="reference internal" href="dependencyinjection.html">Dependency Injection in Requirement Handlers</a></li>
<li class="toctree-l3"><a class="reference internal" href="resourcebased.html">Resource Based Authorization</a></li>
<li class="toctree-l3"><a class="reference internal" href="views.html">View Based Authorization</a></li>
<li class="toctree-l3"><a class="reference internal" href="limitingidentitybyscheme.html">Limiting identity by scheme</a></li>
<li class="toctree-l3"><a class="reference internal" href="authorization-filters.html">ðŸ”§ Authorization Filters</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../data-protection/index.html">Data Protection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../app-secrets.html">Safe storage of app secrets during development</a></li>
<li class="toctree-l2"><a class="reference internal" href="../enforcing-ssl.html">ðŸ”§ Enforcing SSL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../anti-request-forgery.html">ðŸ”§ Anti-Request Forgery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../open-redirect.html">ðŸ”§ Preventing Open Redirect Attacks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cross-site-scripting.html">ðŸ”§ Preventing Cross-Site Scripting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cors.html">Enabling Cross-Origin Requests (CORS)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../performance/index.html">Performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../migration/index.html">Migration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contribute/index.html">Contribute</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">ASP.NET</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../index.html">Security</a> &raquo;</li>
      
          <li><a href="index.html">Authorization</a> &raquo;</li>
      
    <li>Role based Authorization</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/security/authorization/roles.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
  <div class="section" id="role-based-authorization">
<span id="security-authorization-role-based"></span><h1>Role based Authorization<a class="headerlink" href="#role-based-authorization" title="Permalink to this headline">Â¶</a></h1>
<p>When an identity is created it may belong to one or more roles, for example Tracy may belong to the Administrator and User roles whilst Scott may only belong to the user role. How these roles are created and managed depends on the backing store of the authorization process. Roles are exposed to the developer through the <a class="reference external" href="https://msdn.microsoft.com/en-us/library/system.security.claims.claimsprincipal.isinrole(v=vs.110).aspx">IsInRole</a> property on the <a class="reference external" href="https://msdn.microsoft.com/en-us/library/system.security.claims.claimsprincipal(v=vs.110).aspx">ClaimsPrincipal</a> class.</p>
<div class="section" id="adding-role-checks">
<h2>Adding role checks<a class="headerlink" href="#adding-role-checks" title="Permalink to this headline">Â¶</a></h2>
<p>Role based authorization checks are declarative - the developer embeds them within their code, against a controller or an action within a controller, specifying roles which the current user must be a member of to access the requested resource.</p>
<p>For example the following code would limit access to any actions on the Administration controller to users who are a member of the Administrator group.</p>
<div class="highlight-c#"><div class="highlight"><pre><span></span><span class="na">[Authorize(Roles = &quot;Administrator&quot;)]</span>
<span class="k">public</span> <span class="k">class</span> <span class="nc">AdministrationController</span> <span class="p">:</span> <span class="n">Controller</span>
<span class="p">{</span>
<span class="p">}</span>
</pre></div>
</div>
<p>You can specify multiple roles as a comma separated list;</p>
<div class="highlight-c#"><div class="highlight"><pre><span></span><span class="na">[Authorize(Roles = &quot;HRManager,Finance&quot;)]</span>
<span class="k">public</span> <span class="k">class</span> <span class="nc">SalaryController</span> <span class="p">:</span> <span class="n">Controller</span>
<span class="p">{</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This controller would be only accessible by users who are members of the HRManager role or the Finance Role.</p>
<p>If you apply multiple attributes then an accessing user must be a member of all the roles specified; the following sample requires that a user must be a member of both the PowerUser and ControlPanelUser role.</p>
<div class="highlight-c#"><div class="highlight"><pre><span></span><span class="na">[Authorize(Roles = &quot;PowerUser&quot;)]</span>
<span class="na">[Authorize(Roles = &quot;ControlPanelUser&quot;)]</span>
<span class="k">public</span> <span class="k">class</span> <span class="nc">ControlPanelController</span> <span class="p">:</span> <span class="n">Controller</span>
<span class="p">{</span>
<span class="p">}</span>
</pre></div>
</div>
<p>You can further limit access by applying additional role authorization attributes at the action level;</p>
<div class="highlight-c#"><div class="highlight"><pre><span></span><span class="na">[Authorize(Roles = &quot;Administrator, PowerUser&quot;)]</span>
<span class="k">public</span> <span class="k">class</span> <span class="nc">ControlPanelController</span> <span class="p">:</span> <span class="n">Controller</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="n">ActionResult</span> <span class="nf">SetTime</span><span class="p">()</span>
    <span class="p">{</span>
    <span class="p">}</span>

<span class="na">    [Authorize(Roles = &quot;Administrator&quot;)]</span>
    <span class="k">public</span> <span class="n">ActionResult</span> <span class="nf">ShutDown</span><span class="p">()</span>
    <span class="p">{</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In the previous code snippet both members of the Administrator role and the PowerUser role can access the controller and the SetTime action, but only members of the Administrator role can access the ShutDown action.</p>
<p>You can also lock down a controller but allow anonymous, unauthenticated access to individual actions.</p>
<div class="highlight-c#"><div class="highlight"><pre><span></span><span class="na">[Authorize]</span>
<span class="k">public</span> <span class="k">class</span> <span class="nc">ControlPanelController</span> <span class="p">:</span> <span class="n">Controller</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="n">ActionResult</span> <span class="nf">SetTime</span><span class="p">()</span>
    <span class="p">{</span>
    <span class="p">}</span>

<span class="na">    [AllowAnonymous]</span>
    <span class="k">public</span> <span class="n">ActionResult</span> <span class="nf">Login</span><span class="p">()</span>
    <span class="p">{</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="policy-based-role-checks">
<span id="security-authorization-role-policy"></span><h2>Policy based role checks<a class="headerlink" href="#policy-based-role-checks" title="Permalink to this headline">Â¶</a></h2>
<p>Role requirements can also be expressed using the new Policy syntax, where a developer registers a policy at startup as part of the Authorization service configuration. This normally takes part in <code class="docutils literal"><span class="pre">ConfigureServices()</span></code> in your <em>Startup.cs</em> file.</p>
<div class="highlight-c#"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">void</span> <span class="nf">ConfigureServices</span><span class="p">(</span><span class="n">IServiceCollection</span> <span class="n">services</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">services</span><span class="p">.</span><span class="n">AddMvc</span><span class="p">();</span>

    <span class="n">services</span><span class="p">.</span><span class="n">AddAuthorization</span><span class="p">(</span><span class="n">options</span> <span class="p">=&gt;</span>
    <span class="p">{</span>
        <span class="n">options</span><span class="p">.</span><span class="n">AddPolicy</span><span class="p">(</span><span class="s">&quot;RequireAdministratorRole&quot;</span><span class="p">,</span> <span class="n">policy</span> <span class="p">=&gt;</span> <span class="n">policy</span><span class="p">.</span><span class="n">RequireRole</span><span class="p">(</span><span class="s">&quot;Administrator&quot;</span><span class="p">));</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Policies are applied using the <code class="docutils literal"><span class="pre">Policy</span></code> parameter on the <code class="docutils literal"><span class="pre">Authorize</span></code> attribute;</p>
<div class="highlight-c#"><div class="highlight"><pre><span></span><span class="na">[Authorize(Policy = &quot;RequireAdministratorRole&quot;)]</span>
<span class="k">public</span> <span class="n">IActionResult</span> <span class="nf">Shutdown</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="nf">View</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If you want to specify multiple allowed roles in a requirement then you can specify them as parameters to the <code class="docutils literal"><span class="pre">RequireRole</span></code> method;</p>
<div class="highlight-c#"><div class="highlight"><pre><span></span><span class="n">options</span><span class="p">.</span><span class="n">AddPolicy</span><span class="p">(</span><span class="s">&quot;ElevatedRights&quot;</span><span class="p">,</span> <span class="n">policy</span> <span class="p">=&gt;</span>
                  <span class="n">policy</span><span class="p">.</span><span class="n">RequireRole</span><span class="p">(</span><span class="s">&quot;Administrator&quot;</span><span class="p">,</span> <span class="s">&quot;PowerUser&quot;</span><span class="p">,</span> <span class="s">&quot;BackupAdministrator&quot;</span><span class="p">));</span>
</pre></div>
</div>
<p>This example would authorize any user who has a role of Administrator, PowerUser and/or BackupAdministrator.</p>
</div>
</div>



  
  <!-- Helpfulness -->
  <div id="helpful-position"></div>
  <div id="helpful" class="helpfulness-container" style="display:none;">
    <div class="helpfulness">
      <div class="helpfulness-form">
        <h2>Is this page helpful?</h2>
        <a id="helpfulness-btn-yes" href="javascript:;" class="common-btn first">Yes</a>
        <a id="helpfulness-btn-no" href="javascript:;" class="common-btn">No</a>
      </div>
      <div class="helpfulness-form-no" style="display:none;">
        <h2>Is this page helpful?</h2>
        Sorry this wasn't helpful.
        <input type="text" id="txt-helpfulness" placeholder="Please let us know why this wasn't helpful">
        <span id="helpfulness-characters-left">characters remaining</span>
        <a id="helpfulness-btn-submit" href="javascript:;" class="common-btn">Submit</a>
        <a id="helpfulness-btn-skip" href="javascript:;" class="common-btn secondary">Skip this</a>
      </div>
      <a href="javascript:;" class="helpfulness-close">âœ–</a>
      <div class="messages processing" style="display:none;">
        Sending feedback...
      </div>
      <div class="messages success" style="display:none;">
        Thank you for your feedback!
      </div>
      <div class="messages helpfulness-error" style="display:none;">
        Error during submission!
      </div>
    </div>
  </div>
  

  <!-- wedc -->
  <noscript>
    <img alt="" width="1" height="1" src="https://c.microsoft.com/trans_pixel.aspx"/>
  </noscript>

  
    <!-- disqus -->
    <button id="showComments" type="button" class="btn btn-neutral"><i class="fa fa-comment"></i> Show comments</button>
    <div id="disqus_thread"></div>
    <hr/>
  
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="claims.html" class="btn btn-neutral float-right" title="Claims-Based Authorization" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="simple.html" class="btn btn-neutral" title="Simple Authorization" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Microsoft.
      Last updated on Jun 21, 2016.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  Documentation licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>.


</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="../../_static/helpfulness.js?v=6"></script>
      <script type="text/javascript" src="../../_static/disqus.js?v=6"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>